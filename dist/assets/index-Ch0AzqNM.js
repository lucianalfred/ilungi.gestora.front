var e,t,s,a,r,i,l,n,o,d,c,u,m,h,p,x,f,b,v,g,y,k,w,j,N,A,S,E,T,C,O,D,M,P,R,I,U,z,F,L,q,$,_,W,Q,V,G,H,K,Y,B,J,X,Z,ee,te,se,ae,re,ie,le,ne,oe,de,ce,ue,me,he,pe,xe,fe,be,ve,ge,ye,ke,we,je,Ne,Ae,Se,Ee,Te,Ce,Oe,De,Me,Pe,Re=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},Ie=(e,t,s)=>(Re(e,t,"read from private field"),s?s.call(e):t.get(e)),Ue=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},ze=(e,t,s,a)=>(Re(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s),Fe=(e,t,s,a)=>({set _(a){ze(e,t,a,s)},get _(){return Ie(e,t,a)}}),Le=(e,t,s)=>(Re(e,t,"access private method"),s);import{r as qe,a as $e,R as _e}from"./vendor-DtX1tuCI.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var We={exports:{}},Qe={},Ve=qe,Ge=Symbol.for("react.element"),He=Symbol.for("react.fragment"),Ke=Object.prototype.hasOwnProperty,Ye=Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Be={key:!0,ref:!0,__self:!0,__source:!0};function Je(e,t,s){var a,r={},i=null,l=null;for(a in void 0!==s&&(i=""+s),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(l=t.ref),t)Ke.call(t,a)&&!Be.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:Ge,type:e,key:i,ref:l,props:r,_owner:Ye.current}}Qe.Fragment=He,Qe.jsx=Je,Qe.jsxs=Je,We.exports=Qe;var Xe=We.exports,Ze={},et=$e;Ze.createRoot=et.createRoot,Ze.hydrateRoot=et.hydrateRoot;var tt=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},st={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},at=new(s=class{constructor(){Ue(this,e,st),Ue(this,t,!1)}setTimeoutProvider(t){ze(this,e,t)}setTimeout(t,s){return Ie(this,e).setTimeout(t,s)}clearTimeout(t){Ie(this,e).clearTimeout(t)}setInterval(t,s){return Ie(this,e).setInterval(t,s)}clearInterval(t){Ie(this,e).clearInterval(t)}},e=new WeakMap,t=new WeakMap,s);var rt="undefined"==typeof window||"Deno"in globalThis;function it(){}function lt(e){return"number"==typeof e&&e>=0&&e!==1/0}function nt(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ot(e,t){return"function"==typeof e?e(t):e}function dt(e,t){return"function"==typeof e?e(t):e}function ct(e,t){const{type:s="all",exact:a,fetchStatus:r,predicate:i,queryKey:l,stale:n}=e;if(l)if(a){if(t.queryHash!==mt(l,t.options))return!1}else if(!pt(t.queryKey,l))return!1;if("all"!==s){const e=t.isActive();if("active"===s&&!e)return!1;if("inactive"===s&&e)return!1}return("boolean"!=typeof n||t.isStale()===n)&&((!r||r===t.state.fetchStatus)&&!(i&&!i(t)))}function ut(e,t){const{exact:s,status:a,predicate:r,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(s){if(ht(t.options.mutationKey)!==ht(i))return!1}else if(!pt(t.options.mutationKey,i))return!1}return(!a||t.state.status===a)&&!(r&&!r(t))}function mt(e,t){return((null==t?void 0:t.queryKeyHashFn)||ht)(e)}function ht(e){return JSON.stringify(e,(e,t)=>gt(t)?Object.keys(t).sort().reduce((e,s)=>(e[s]=t[s],e),{}):t)}function pt(e,t){return e===t||typeof e==typeof t&&(!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&Object.keys(t).every(s=>pt(e[s],t[s])))}var xt=Object.prototype.hasOwnProperty;function ft(e,t,s=0){if(e===t)return e;if(s>500)return t;const a=vt(e)&&vt(t);if(!(a||gt(e)&&gt(t)))return t;const r=(a?e:Object.keys(e)).length,i=a?t:Object.keys(t),l=i.length,n=a?new Array(l):{};let o=0;for(let d=0;d<l;d++){const l=a?d:i[d],c=e[l],u=t[l];if(c===u){n[l]=c,(a?d<r:xt.call(e,l))&&o++;continue}if(null===c||null===u||"object"!=typeof c||"object"!=typeof u){n[l]=u;continue}const m=ft(c,u,s+1);n[l]=m,m===c&&o++}return r===l&&o===r?e:n}function bt(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function vt(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function gt(e){if(!yt(e))return!1;const t=e.constructor;if(void 0===t)return!0;const s=t.prototype;return!!yt(s)&&(!!s.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype)}function yt(e){return"[object Object]"===Object.prototype.toString.call(e)}function kt(e,t,s){return"function"==typeof s.structuralSharing?s.structuralSharing(e,t):!1!==s.structuralSharing?ft(e,t):t}function wt(e,t,s=0){const a=[...e,t];return s&&a.length>s?a.slice(1):a}function jt(e,t,s=0){const a=[t,...e];return s&&a.length>s?a.slice(0,-1):a}var Nt=Symbol();function At(e,t){return!e.queryFn&&(null==t?void 0:t.initialPromise)?()=>t.initialPromise:e.queryFn&&e.queryFn!==Nt?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}function St(e,t){return"function"==typeof e?e(...t):!!e}var Et=new(l=class extends tt{constructor(){super(),Ue(this,a,void 0),Ue(this,r,void 0),Ue(this,i,void 0),ze(this,i,e=>{if(!rt&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){Ie(this,r)||this.setEventListener(Ie(this,i))}onUnsubscribe(){var e;this.hasListeners()||(null==(e=Ie(this,r))||e.call(this),ze(this,r,void 0))}setEventListener(e){var t;ze(this,i,e),null==(t=Ie(this,r))||t.call(this),ze(this,r,e(e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()}))}setFocused(e){Ie(this,a)!==e&&(ze(this,a,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return"boolean"==typeof Ie(this,a)?Ie(this,a):"hidden"!==(null==(e=globalThis.document)?void 0:e.visibilityState)}},a=new WeakMap,r=new WeakMap,i=new WeakMap,l);function Tt(){let e,t;const s=new Promise((s,a)=>{e=s,t=a});function a(e){Object.assign(s,e),delete s.resolve,delete s.reject}return s.status="pending",s.catch(()=>{}),s.resolve=t=>{a({status:"fulfilled",value:t}),e(t)},s.reject=e=>{a({status:"rejected",reason:e}),t(e)},s}var Ct=function(e){setTimeout(e,0)};var Ot=function(){let e=[],t=0,s=e=>{e()},a=e=>{e()},r=Ct;const i=a=>{t?e.push(a):r(()=>{s(a)})};return{batch:i=>{let l;t++;try{l=i()}finally{t--,t||(()=>{const t=e;e=[],t.length&&r(()=>{a(()=>{t.forEach(e=>{s(e)})})})})()}return l},batchCalls:e=>(...t)=>{i(()=>{e(...t)})},schedule:i,setNotifyFunction:e=>{s=e},setBatchNotifyFunction:e=>{a=e},setScheduler:e=>{r=e}}}(),Dt=new(c=class extends tt{constructor(){super(),Ue(this,n,!0),Ue(this,o,void 0),Ue(this,d,void 0),ze(this,d,e=>{if(!rt&&window.addEventListener){const t=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}})}onSubscribe(){Ie(this,o)||this.setEventListener(Ie(this,d))}onUnsubscribe(){var e;this.hasListeners()||(null==(e=Ie(this,o))||e.call(this),ze(this,o,void 0))}setEventListener(e){var t;ze(this,d,e),null==(t=Ie(this,o))||t.call(this),ze(this,o,e(this.setOnline.bind(this)))}setOnline(e){Ie(this,n)!==e&&(ze(this,n,e),this.listeners.forEach(t=>{t(e)}))}isOnline(){return Ie(this,n)}},n=new WeakMap,o=new WeakMap,d=new WeakMap,c);function Mt(e){return Math.min(1e3*2**e,3e4)}function Pt(e){return"online"!==(e??"online")||Dt.isOnline()}var Rt=class extends Error{constructor(e){super("CancelledError"),this.revert=null==e?void 0:e.revert,this.silent=null==e?void 0:e.silent}};function It(e){let t,s=!1,a=0;const r=Tt(),i=()=>"pending"!==r.status,l=()=>Et.isFocused()&&("always"===e.networkMode||Dt.isOnline())&&e.canRun(),n=()=>Pt(e.networkMode)&&e.canRun(),o=e=>{i()||(null==t||t(),r.resolve(e))},d=e=>{i()||(null==t||t(),r.reject(e))},c=()=>new Promise(s=>{var a;t=e=>{(i()||l())&&s(e)},null==(a=e.onPause)||a.call(e)}).then(()=>{var s;t=void 0,i()||null==(s=e.onContinue)||s.call(e)}),u=()=>{if(i())return;let t;const r=0===a?e.initialPromise:void 0;try{t=r??e.fn()}catch(n){t=Promise.reject(n)}Promise.resolve(t).then(o).catch(t=>{var r;if(i())return;const n=e.retry??(rt?0:3),o=e.retryDelay??Mt,m="function"==typeof o?o(a,t):o,h=!0===n||"number"==typeof n&&a<n||"function"==typeof n&&n(a,t);var p;!s&&h?(a++,null==(r=e.onFail)||r.call(e,a,t),(p=m,new Promise(e=>{at.setTimeout(e,p)})).then(()=>l()?void 0:c()).then(()=>{s?d(t):u()})):d(t)})};return{promise:r,status:()=>r.status,cancel:t=>{var s;if(!i()){const a=new Rt(t);d(a),null==(s=e.onCancel)||s.call(e,a)}},continue:()=>(null==t||t(),r),cancelRetry:()=>{s=!0},continueRetry:()=>{s=!1},canStart:n,start:()=>(n()?u():c().then(u),r)}}var Ut=(m=class{constructor(){Ue(this,u,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),lt(this.gcTime)&&ze(this,u,at.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(rt?1/0:3e5))}clearGcTimeout(){Ie(this,u)&&(at.clearTimeout(Ie(this,u)),ze(this,u,void 0))}},u=new WeakMap,m),zt=(w=class extends Ut{constructor(e){super(),Ue(this,y),Ue(this,h,void 0),Ue(this,p,void 0),Ue(this,x,void 0),Ue(this,f,void 0),Ue(this,b,void 0),Ue(this,v,void 0),Ue(this,g,void 0),ze(this,g,!1),ze(this,v,e.defaultOptions),this.setOptions(e.options),this.observers=[],ze(this,f,e.client),ze(this,x,Ie(this,f).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,ze(this,h,qt(this.options)),this.state=e.state??Ie(this,h),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return null==(e=Ie(this,b))?void 0:e.promise}setOptions(e){if(this.options={...Ie(this,v),...e},this.updateGcTime(this.options.gcTime),this.state&&void 0===this.state.data){const e=qt(this.options);void 0!==e.data&&(this.setState(Lt(e.data,e.dataUpdatedAt)),ze(this,h,e))}}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||Ie(this,x).remove(this)}setData(e,t){const s=kt(this.state.data,e,this.options);return Le(this,y,k).call(this,{data:s,type:"success",dataUpdatedAt:null==t?void 0:t.updatedAt,manual:null==t?void 0:t.manual}),s}setState(e,t){Le(this,y,k).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var t,s;const a=null==(t=Ie(this,b))?void 0:t.promise;return null==(s=Ie(this,b))||s.cancel(e),a?a.then(it).catch(it):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Ie(this,h))}isActive(){return this.observers.some(e=>!1!==dt(e.options.enabled,this))}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Nt||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some(e=>"static"===ot(e.options.staleTime,this))}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(e=0){return void 0===this.state.data||"static"!==e&&(!!this.state.isInvalidated||!nt(this.state.dataUpdatedAt,e))}onFocus(){var e;const t=this.observers.find(e=>e.shouldFetchOnWindowFocus());null==t||t.refetch({cancelRefetch:!1}),null==(e=Ie(this,b))||e.continue()}onOnline(){var e;const t=this.observers.find(e=>e.shouldFetchOnReconnect());null==t||t.refetch({cancelRefetch:!1}),null==(e=Ie(this,b))||e.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),Ie(this,x).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(Ie(this,b)&&(Ie(this,g)?Ie(this,b).cancel({revert:!0}):Ie(this,b).cancelRetry()),this.scheduleGc()),Ie(this,x).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Le(this,y,k).call(this,{type:"invalidate"})}async fetch(e,t){var s,a,r,i,l,n,o,d,c,u,m,h;if("idle"!==this.state.fetchStatus&&"rejected"!==(null==(s=Ie(this,b))?void 0:s.status()))if(void 0!==this.state.data&&(null==t?void 0:t.cancelRefetch))this.cancel({silent:!0});else if(Ie(this,b))return Ie(this,b).continueRetry(),Ie(this,b).promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find(e=>e.options.queryFn);e&&this.setOptions(e.options)}const v=new AbortController,w=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(ze(this,g,!0),v.signal)})},j=()=>{const e=At(this.options,t),s=(()=>{const e={client:Ie(this,f),queryKey:this.queryKey,meta:this.meta};return w(e),e})();return ze(this,g,!1),this.options.persister?this.options.persister(e,s,this):e(s)},N=(()=>{const e={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:Ie(this,f),state:this.state,fetchFn:j};return w(e),e})();null==(a=this.options.behavior)||a.onFetch(N,this),ze(this,p,this.state),"idle"!==this.state.fetchStatus&&this.state.fetchMeta===(null==(r=N.fetchOptions)?void 0:r.meta)||Le(this,y,k).call(this,{type:"fetch",meta:null==(i=N.fetchOptions)?void 0:i.meta}),ze(this,b,It({initialPromise:null==t?void 0:t.initialPromise,fn:N.fetchFn,onCancel:e=>{e instanceof Rt&&e.revert&&this.setState({...Ie(this,p),fetchStatus:"idle"}),v.abort()},onFail:(e,t)=>{Le(this,y,k).call(this,{type:"failed",failureCount:e,error:t})},onPause:()=>{Le(this,y,k).call(this,{type:"pause"})},onContinue:()=>{Le(this,y,k).call(this,{type:"continue"})},retry:N.options.retry,retryDelay:N.options.retryDelay,networkMode:N.options.networkMode,canRun:()=>!0}));try{const e=await Ie(this,b).start();if(void 0===e)throw new Error(`${this.queryHash} data is undefined`);return this.setData(e),null==(n=(l=Ie(this,x).config).onSuccess)||n.call(l,e,this),null==(d=(o=Ie(this,x).config).onSettled)||d.call(o,e,this.state.error,this),e}catch(A){if(A instanceof Rt){if(A.silent)return Ie(this,b).promise;if(A.revert){if(void 0===this.state.data)throw A;return this.state.data}}throw Le(this,y,k).call(this,{type:"error",error:A}),null==(u=(c=Ie(this,x).config).onError)||u.call(c,A,this),null==(h=(m=Ie(this,x).config).onSettled)||h.call(m,this.state.data,A,this),A}finally{this.scheduleGc()}}},h=new WeakMap,p=new WeakMap,x=new WeakMap,f=new WeakMap,b=new WeakMap,v=new WeakMap,g=new WeakMap,y=new WeakSet,k=function(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...Ft(t.data,this.options),fetchMeta:e.meta??null};case"success":const s={...t,...Lt(e.data,e.dataUpdatedAt),dataUpdateCount:t.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ze(this,p,e.manual?s:void 0),s;case"error":const a=e.error;return{...t,error:a,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}})(this.state),Ot.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),Ie(this,x).notify({query:this,type:"updated",action:e})})},w);function Ft(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Pt(t.networkMode)?"fetching":"paused",...void 0===e&&{error:null,status:"pending"}}}function Lt(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function qt(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,s=void 0!==t,a=s?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var $t=(se=class extends tt{constructor(e,t){super(),Ue(this,F),Ue(this,q),Ue(this,_),Ue(this,Q),Ue(this,G),Ue(this,K),Ue(this,B),Ue(this,X),Ue(this,ee),Ue(this,j,void 0),Ue(this,N,void 0),Ue(this,A,void 0),Ue(this,S,void 0),Ue(this,E,void 0),Ue(this,T,void 0),Ue(this,C,void 0),Ue(this,O,void 0),Ue(this,D,void 0),Ue(this,M,void 0),Ue(this,P,void 0),Ue(this,R,void 0),Ue(this,I,void 0),Ue(this,U,void 0),Ue(this,z,new Set),this.options=t,ze(this,j,e),ze(this,O,null),ze(this,C,Tt()),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(Ie(this,N).addObserver(this),_t(Ie(this,N),this.options)?Le(this,F,L).call(this):this.updateResult(),Le(this,G,H).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Wt(Ie(this,N),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Wt(Ie(this,N),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Le(this,K,Y).call(this),Le(this,B,J).call(this),Ie(this,N).removeObserver(this)}setOptions(e){const t=this.options,s=Ie(this,N);if(this.options=Ie(this,j).defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof dt(this.options.enabled,Ie(this,N)))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Le(this,X,Z).call(this),Ie(this,N).setOptions(this.options),t._defaulted&&!bt(this.options,t)&&Ie(this,j).getQueryCache().notify({type:"observerOptionsUpdated",query:Ie(this,N),observer:this});const a=this.hasListeners();a&&Qt(Ie(this,N),s,this.options,t)&&Le(this,F,L).call(this),this.updateResult(),!a||Ie(this,N)===s&&dt(this.options.enabled,Ie(this,N))===dt(t.enabled,Ie(this,N))&&ot(this.options.staleTime,Ie(this,N))===ot(t.staleTime,Ie(this,N))||Le(this,q,$).call(this);const r=Le(this,_,W).call(this);!a||Ie(this,N)===s&&dt(this.options.enabled,Ie(this,N))===dt(t.enabled,Ie(this,N))&&r===Ie(this,U)||Le(this,Q,V).call(this,r)}getOptimisticResult(e){const t=Ie(this,j).getQueryCache().build(Ie(this,j),e),s=this.createResult(t,e);return function(e,t){if(!bt(e.getCurrentResult(),t))return!0;return!1}(this,s)&&(ze(this,S,s),ze(this,T,this.options),ze(this,E,Ie(this,N).state)),s}getCurrentResult(){return Ie(this,S)}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),null==t||t(s),"promise"===s&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==Ie(this,C).status||Ie(this,C).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,s))})}trackProp(e){Ie(this,z).add(e)}getCurrentQuery(){return Ie(this,N)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=Ie(this,j).defaultQueryOptions(e),s=Ie(this,j).getQueryCache().build(Ie(this,j),t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return Le(this,F,L).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),Ie(this,S)))}createResult(e,t){var s;const a=Ie(this,N),r=this.options,i=Ie(this,S),l=Ie(this,E),n=Ie(this,T),o=e!==a?e.state:Ie(this,A),{state:d}=e;let c,u={...d},m=!1;if(t._optimisticResults){const s=this.hasListeners(),i=!s&&_t(e,t),l=s&&Qt(e,a,t,r);(i||l)&&(u={...u,...Ft(d.data,e.options)}),"isRestoring"===t._optimisticResults&&(u.fetchStatus="idle")}let{error:h,errorUpdatedAt:p,status:x}=u;c=u.data;let f=!1;if(void 0!==t.placeholderData&&void 0===c&&"pending"===x){let e;(null==i?void 0:i.isPlaceholderData)&&t.placeholderData===(null==n?void 0:n.placeholderData)?(e=i.data,f=!0):e="function"==typeof t.placeholderData?t.placeholderData(null==(s=Ie(this,P))?void 0:s.state.data,Ie(this,P)):t.placeholderData,void 0!==e&&(x="success",c=kt(null==i?void 0:i.data,e,t),m=!0)}if(t.select&&void 0!==c&&!f)if(i&&c===(null==l?void 0:l.data)&&t.select===Ie(this,D))c=Ie(this,M);else try{ze(this,D,t.select),c=t.select(c),c=kt(null==i?void 0:i.data,c,t),ze(this,M,c),ze(this,O,null)}catch(j){ze(this,O,j)}Ie(this,O)&&(h=Ie(this,O),c=Ie(this,M),p=Date.now(),x="error");const b="fetching"===u.fetchStatus,v="pending"===x,g="error"===x,y=v&&b,k=void 0!==c,w={status:x,fetchStatus:u.fetchStatus,isPending:v,isSuccess:"success"===x,isError:g,isInitialLoading:y,isLoading:y,data:c,dataUpdatedAt:u.dataUpdatedAt,error:h,errorUpdatedAt:p,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>o.dataUpdateCount||u.errorUpdateCount>o.errorUpdateCount,isFetching:b,isRefetching:b&&!v,isLoadingError:g&&!k,isPaused:"paused"===u.fetchStatus,isPlaceholderData:m,isRefetchError:g&&k,isStale:Vt(e,t),refetch:this.refetch,promise:Ie(this,C),isEnabled:!1!==dt(t.enabled,e)};if(this.options.experimental_prefetchInRender){const t=void 0!==w.data,s="error"===w.status&&!t,r=e=>{s?e.reject(w.error):t&&e.resolve(w.data)},i=()=>{const e=ze(this,C,w.promise=Tt());r(e)},l=Ie(this,C);switch(l.status){case"pending":e.queryHash===a.queryHash&&r(l);break;case"fulfilled":(s||w.data!==l.value)&&i();break;case"rejected":s&&w.error===l.reason||i()}}return w}updateResult(){const e=Ie(this,S),t=this.createResult(Ie(this,N),this.options);if(ze(this,E,Ie(this,N).state),ze(this,T,this.options),void 0!==Ie(this,E).data&&ze(this,P,Ie(this,N)),bt(t,e))return;ze(this,S,t);Le(this,ee,te).call(this,{listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!Ie(this,z).size)return!0;const a=new Set(s??Ie(this,z));return this.options.throwOnError&&a.add("error"),Object.keys(Ie(this,S)).some(t=>{const s=t;return Ie(this,S)[s]!==e[s]&&a.has(s)})})()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Le(this,G,H).call(this)}},j=new WeakMap,N=new WeakMap,A=new WeakMap,S=new WeakMap,E=new WeakMap,T=new WeakMap,C=new WeakMap,O=new WeakMap,D=new WeakMap,M=new WeakMap,P=new WeakMap,R=new WeakMap,I=new WeakMap,U=new WeakMap,z=new WeakMap,F=new WeakSet,L=function(e){Le(this,X,Z).call(this);let t=Ie(this,N).fetch(this.options,e);return(null==e?void 0:e.throwOnError)||(t=t.catch(it)),t},q=new WeakSet,$=function(){Le(this,K,Y).call(this);const e=ot(this.options.staleTime,Ie(this,N));if(rt||Ie(this,S).isStale||!lt(e))return;const t=nt(Ie(this,S).dataUpdatedAt,e)+1;ze(this,R,at.setTimeout(()=>{Ie(this,S).isStale||this.updateResult()},t))},_=new WeakSet,W=function(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(Ie(this,N)):this.options.refetchInterval)??!1},Q=new WeakSet,V=function(e){Le(this,B,J).call(this),ze(this,U,e),!rt&&!1!==dt(this.options.enabled,Ie(this,N))&&lt(Ie(this,U))&&0!==Ie(this,U)&&ze(this,I,at.setInterval(()=>{(this.options.refetchIntervalInBackground||Et.isFocused())&&Le(this,F,L).call(this)},Ie(this,U)))},G=new WeakSet,H=function(){Le(this,q,$).call(this),Le(this,Q,V).call(this,Le(this,_,W).call(this))},K=new WeakSet,Y=function(){Ie(this,R)&&(at.clearTimeout(Ie(this,R)),ze(this,R,void 0))},B=new WeakSet,J=function(){Ie(this,I)&&(at.clearInterval(Ie(this,I)),ze(this,I,void 0))},X=new WeakSet,Z=function(){const e=Ie(this,j).getQueryCache().build(Ie(this,j),this.options);if(e===Ie(this,N))return;const t=Ie(this,N);ze(this,N,e),ze(this,A,e.state),this.hasListeners()&&(null==t||t.removeObserver(this),e.addObserver(this))},ee=new WeakSet,te=function(e){Ot.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(Ie(this,S))}),Ie(this,j).getQueryCache().notify({query:Ie(this,N),type:"observerResultsUpdated"})})},se);function _t(e,t){return function(e,t){return!1!==dt(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&Wt(e,t,t.refetchOnMount)}function Wt(e,t,s){if(!1!==dt(t.enabled,e)&&"static"!==ot(t.staleTime,e)){const a="function"==typeof s?s(e):s;return"always"===a||!1!==a&&Vt(e,t)}return!1}function Qt(e,t,s,a){return(e!==t||!1===dt(a.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&Vt(e,s)}function Vt(e,t){return!1!==dt(t.enabled,e)&&e.isStaleByTime(ot(t.staleTime,e))}function Gt(e){return{onFetch:(t,s)=>{var a,r,i,l,n;const o=t.options,d=null==(i=null==(r=null==(a=t.fetchOptions)?void 0:a.meta)?void 0:r.fetchMore)?void 0:i.direction,c=(null==(l=t.state.data)?void 0:l.pages)||[],u=(null==(n=t.state.data)?void 0:n.pageParams)||[];let m={pages:[],pageParams:[]},h=0;const p=async()=>{let s=!1;const a=e=>{!function(e,t,s){let a,r=!1;Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(a??(a=t()),r||(r=!0,a.aborted?s():a.addEventListener("abort",s,{once:!0})),a)})}(e,()=>t.signal,()=>s=!0)},r=At(t.options,t.fetchOptions),i=async(e,i,l)=>{if(s)return Promise.reject();if(null==i&&e.pages.length)return Promise.resolve(e);const n=(()=>{const e={client:t.client,queryKey:t.queryKey,pageParam:i,direction:l?"backward":"forward",meta:t.options.meta};return a(e),e})(),o=await r(n),{maxPages:d}=t.options,c=l?jt:wt;return{pages:c(e.pages,o,d),pageParams:c(e.pageParams,i,d)}};if(d&&c.length){const e="backward"===d,t={pages:c,pageParams:u},s=(e?Kt:Ht)(o,t);m=await i(t,s,e)}else{const t=e??c.length;do{const e=0===h?u[0]??o.initialPageParam:Ht(o,m);if(h>0&&null==e)break;m=await i(m,e),h++}while(h<t)}return m};t.options.persister?t.fetchFn=()=>{var e,a;return null==(a=(e=t.options).persister)?void 0:a.call(e,p,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s)}:t.fetchFn=p}}}function Ht(e,{pages:t,pageParams:s}){const a=t.length-1;return t.length>0?e.getNextPageParam(t[a],t,s[a],s):void 0}function Kt(e,{pages:t,pageParams:s}){var a;return t.length>0?null==(a=e.getPreviousPageParam)?void 0:a.call(e,t[0],t,s[0],s):void 0}var Yt=(de=class extends Ut{constructor(e){super(),Ue(this,ne),Ue(this,ae,void 0),Ue(this,re,void 0),Ue(this,ie,void 0),Ue(this,le,void 0),ze(this,ae,e.client),this.mutationId=e.mutationId,ze(this,ie,e.mutationCache),ze(this,re,[]),this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){Ie(this,re).includes(e)||(Ie(this,re).push(e),this.clearGcTimeout(),Ie(this,ie).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){ze(this,re,Ie(this,re).filter(t=>t!==e)),this.scheduleGc(),Ie(this,ie).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){Ie(this,re).length||("pending"===this.state.status?this.scheduleGc():Ie(this,ie).remove(this))}continue(){var e;return(null==(e=Ie(this,le))?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var t,s,a,r,i,l,n,o,d,c,u,m,h,p,x,f,b,v;const g=()=>{Le(this,ne,oe).call(this,{type:"continue"})},y={client:Ie(this,ae),meta:this.options.meta,mutationKey:this.options.mutationKey};ze(this,le,It({fn:()=>this.options.mutationFn?this.options.mutationFn(e,y):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{Le(this,ne,oe).call(this,{type:"failed",failureCount:e,error:t})},onPause:()=>{Le(this,ne,oe).call(this,{type:"pause"})},onContinue:g,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Ie(this,ie).canRun(this)}));const k="pending"===this.state.status,w=!Ie(this,le).canStart();try{if(k)g();else{Le(this,ne,oe).call(this,{type:"pending",variables:e,isPaused:w}),Ie(this,ie).config.onMutate&&await Ie(this,ie).config.onMutate(e,this,y);const a=await(null==(s=(t=this.options).onMutate)?void 0:s.call(t,e,y));a!==this.state.context&&Le(this,ne,oe).call(this,{type:"pending",context:a,variables:e,isPaused:w})}const u=await Ie(this,le).start();return await(null==(r=(a=Ie(this,ie).config).onSuccess)?void 0:r.call(a,u,e,this.state.context,this,y)),await(null==(l=(i=this.options).onSuccess)?void 0:l.call(i,u,e,this.state.context,y)),await(null==(o=(n=Ie(this,ie).config).onSettled)?void 0:o.call(n,u,null,this.state.variables,this.state.context,this,y)),await(null==(c=(d=this.options).onSettled)?void 0:c.call(d,u,null,e,this.state.context,y)),Le(this,ne,oe).call(this,{type:"success",data:u}),u}catch(j){try{await(null==(m=(u=Ie(this,ie).config).onError)?void 0:m.call(u,j,e,this.state.context,this,y))}catch(N){Promise.reject(N)}try{await(null==(p=(h=this.options).onError)?void 0:p.call(h,j,e,this.state.context,y))}catch(N){Promise.reject(N)}try{await(null==(f=(x=Ie(this,ie).config).onSettled)?void 0:f.call(x,void 0,j,this.state.variables,this.state.context,this,y))}catch(N){Promise.reject(N)}try{await(null==(v=(b=this.options).onSettled)?void 0:v.call(b,void 0,j,e,this.state.context,y))}catch(N){Promise.reject(N)}throw Le(this,ne,oe).call(this,{type:"error",error:j}),j}finally{Ie(this,ie).runNext(this)}}},ae=new WeakMap,re=new WeakMap,ie=new WeakMap,le=new WeakMap,ne=new WeakSet,oe=function(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),Ot.batch(()=>{Ie(this,re).forEach(t=>{t.onMutationUpdate(e)}),Ie(this,ie).notify({mutation:this,type:"updated",action:e})})},de);var Bt=(he=class extends tt{constructor(e={}){super(),Ue(this,ce,void 0),Ue(this,ue,void 0),Ue(this,me,void 0),this.config=e,ze(this,ce,new Set),ze(this,ue,new Map),ze(this,me,0)}build(e,t,s){const a=new Yt({client:e,mutationCache:this,mutationId:++Fe(this,me)._,options:e.defaultMutationOptions(t),state:s});return this.add(a),a}add(e){Ie(this,ce).add(e);const t=Jt(e);if("string"==typeof t){const s=Ie(this,ue).get(t);s?s.push(e):Ie(this,ue).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(Ie(this,ce).delete(e)){const t=Jt(e);if("string"==typeof t){const s=Ie(this,ue).get(t);if(s)if(s.length>1){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}else s[0]===e&&Ie(this,ue).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Jt(e);if("string"==typeof t){const s=Ie(this,ue).get(t),a=null==s?void 0:s.find(e=>"pending"===e.state.status);return!a||a===e}return!0}runNext(e){var t;const s=Jt(e);if("string"==typeof s){const a=null==(t=Ie(this,ue).get(s))?void 0:t.find(t=>t!==e&&t.state.isPaused);return(null==a?void 0:a.continue())??Promise.resolve()}return Promise.resolve()}clear(){Ot.batch(()=>{Ie(this,ce).forEach(e=>{this.notify({type:"removed",mutation:e})}),Ie(this,ce).clear(),Ie(this,ue).clear()})}getAll(){return Array.from(Ie(this,ce))}find(e){const t={exact:!0,...e};return this.getAll().find(e=>ut(t,e))}findAll(e={}){return this.getAll().filter(t=>ut(e,t))}notify(e){Ot.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(e=>e.state.isPaused);return Ot.batch(()=>Promise.all(e.map(e=>e.continue().catch(it))))}},ce=new WeakMap,ue=new WeakMap,me=new WeakMap,he);function Jt(e){var t;return null==(t=e.options.scope)?void 0:t.id}var Xt=(we=class extends tt{constructor(e,t){super(),Ue(this,ve),Ue(this,ye),Ue(this,pe,void 0),Ue(this,xe,void 0),Ue(this,fe,void 0),Ue(this,be,void 0),ze(this,pe,e),this.setOptions(t),this.bindMethods(),Le(this,ve,ge).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var t;const s=this.options;this.options=Ie(this,pe).defaultMutationOptions(e),bt(this.options,s)||Ie(this,pe).getMutationCache().notify({type:"observerOptionsUpdated",mutation:Ie(this,fe),observer:this}),(null==s?void 0:s.mutationKey)&&this.options.mutationKey&&ht(s.mutationKey)!==ht(this.options.mutationKey)?this.reset():"pending"===(null==(t=Ie(this,fe))?void 0:t.state.status)&&Ie(this,fe).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||null==(e=Ie(this,fe))||e.removeObserver(this)}onMutationUpdate(e){Le(this,ve,ge).call(this),Le(this,ye,ke).call(this,e)}getCurrentResult(){return Ie(this,xe)}reset(){var e;null==(e=Ie(this,fe))||e.removeObserver(this),ze(this,fe,void 0),Le(this,ve,ge).call(this),Le(this,ye,ke).call(this)}mutate(e,t){var s;return ze(this,be,t),null==(s=Ie(this,fe))||s.removeObserver(this),ze(this,fe,Ie(this,pe).getMutationCache().build(Ie(this,pe),this.options)),Ie(this,fe).addObserver(this),Ie(this,fe).execute(e)}},pe=new WeakMap,xe=new WeakMap,fe=new WeakMap,be=new WeakMap,ve=new WeakSet,ge=function(){var e;const t=(null==(e=Ie(this,fe))?void 0:e.state)??{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0};ze(this,xe,{...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset})},ye=new WeakSet,ke=function(e){Ot.batch(()=>{var t,s,a,r,i,l,n,o;if(Ie(this,be)&&this.hasListeners()){const c=Ie(this,xe).variables,u=Ie(this,xe).context,m={client:Ie(this,pe),meta:this.options.meta,mutationKey:this.options.mutationKey};if("success"===(null==e?void 0:e.type)){try{null==(s=(t=Ie(this,be)).onSuccess)||s.call(t,e.data,c,u,m)}catch(d){Promise.reject(d)}try{null==(r=(a=Ie(this,be)).onSettled)||r.call(a,e.data,null,c,u,m)}catch(d){Promise.reject(d)}}else if("error"===(null==e?void 0:e.type)){try{null==(l=(i=Ie(this,be)).onError)||l.call(i,e.error,c,u,m)}catch(d){Promise.reject(d)}try{null==(o=(n=Ie(this,be)).onSettled)||o.call(n,void 0,e.error,c,u,m)}catch(d){Promise.reject(d)}}}this.listeners.forEach(e=>{e(Ie(this,xe))})})},we),Zt=(Ne=class extends tt{constructor(e={}){super(),Ue(this,je,void 0),this.config=e,ze(this,je,new Map)}build(e,t,s){const a=t.queryKey,r=t.queryHash??mt(a,t);let i=this.get(r);return i||(i=new zt({client:e,queryKey:a,queryHash:r,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(a)}),this.add(i)),i}add(e){Ie(this,je).has(e.queryHash)||(Ie(this,je).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=Ie(this,je).get(e.queryHash);t&&(e.destroy(),t===e&&Ie(this,je).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Ot.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return Ie(this,je).get(e)}getAll(){return[...Ie(this,je).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(e=>ct(t,e))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(t=>ct(e,t)):t}notify(e){Ot.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Ot.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Ot.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},je=new WeakMap,Ne),es=(Pe=class{constructor(e={}){Ue(this,Ae,void 0),Ue(this,Se,void 0),Ue(this,Ee,void 0),Ue(this,Te,void 0),Ue(this,Ce,void 0),Ue(this,Oe,void 0),Ue(this,De,void 0),Ue(this,Me,void 0),ze(this,Ae,e.queryCache||new Zt),ze(this,Se,e.mutationCache||new Bt),ze(this,Ee,e.defaultOptions||{}),ze(this,Te,new Map),ze(this,Ce,new Map),ze(this,Oe,0)}mount(){Fe(this,Oe)._++,1===Ie(this,Oe)&&(ze(this,De,Et.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ie(this,Ae).onFocus())})),ze(this,Me,Dt.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ie(this,Ae).onOnline())})))}unmount(){var e,t;Fe(this,Oe)._--,0===Ie(this,Oe)&&(null==(e=Ie(this,De))||e.call(this),ze(this,De,void 0),null==(t=Ie(this,Me))||t.call(this),ze(this,Me,void 0))}isFetching(e){return Ie(this,Ae).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Ie(this,Se).findAll({...e,status:"pending"}).length}getQueryData(e){var t;const s=this.defaultQueryOptions({queryKey:e});return null==(t=Ie(this,Ae).get(s.queryHash))?void 0:t.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=Ie(this,Ae).build(this,t),a=s.state.data;return void 0===a?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(ot(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(e){return Ie(this,Ae).findAll(e).map(({queryKey:e,state:t})=>[e,t.data])}setQueryData(e,t,s){const a=this.defaultQueryOptions({queryKey:e}),r=Ie(this,Ae).get(a.queryHash),i=function(e,t){return"function"==typeof e?e(t):e}(t,null==r?void 0:r.state.data);if(void 0!==i)return Ie(this,Ae).build(this,a).setData(i,{...s,manual:!0})}setQueriesData(e,t,s){return Ot.batch(()=>Ie(this,Ae).findAll(e).map(({queryKey:e})=>[e,this.setQueryData(e,t,s)]))}getQueryState(e){var t;const s=this.defaultQueryOptions({queryKey:e});return null==(t=Ie(this,Ae).get(s.queryHash))?void 0:t.state}removeQueries(e){const t=Ie(this,Ae);Ot.batch(()=>{t.findAll(e).forEach(e=>{t.remove(e)})})}resetQueries(e,t){const s=Ie(this,Ae);return Ot.batch(()=>(s.findAll(e).forEach(e=>{e.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const s={revert:!0,...t},a=Ot.batch(()=>Ie(this,Ae).findAll(e).map(e=>e.cancel(s)));return Promise.all(a).then(it).catch(it)}invalidateQueries(e,t={}){return Ot.batch(()=>(Ie(this,Ae).findAll(e).forEach(e=>{e.invalidate()}),"none"===(null==e?void 0:e.refetchType)?Promise.resolve():this.refetchQueries({...e,type:(null==e?void 0:e.refetchType)??(null==e?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},a=Ot.batch(()=>Ie(this,Ae).findAll(e).filter(e=>!e.isDisabled()&&!e.isStatic()).map(e=>{let t=e.fetch(void 0,s);return s.throwOnError||(t=t.catch(it)),"paused"===e.state.fetchStatus?Promise.resolve():t}));return Promise.all(a).then(it)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const s=Ie(this,Ae).build(this,t);return s.isStaleByTime(ot(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(it).catch(it)}fetchInfiniteQuery(e){return e.behavior=Gt(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(it).catch(it)}ensureInfiniteQueryData(e){return e.behavior=Gt(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Dt.isOnline()?Ie(this,Se).resumePausedMutations():Promise.resolve()}getQueryCache(){return Ie(this,Ae)}getMutationCache(){return Ie(this,Se)}getDefaultOptions(){return Ie(this,Ee)}setDefaultOptions(e){ze(this,Ee,e)}setQueryDefaults(e,t){Ie(this,Te).set(ht(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Ie(this,Te).values()],s={};return t.forEach(t=>{pt(e,t.queryKey)&&Object.assign(s,t.defaultOptions)}),s}setMutationDefaults(e,t){Ie(this,Ce).set(ht(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Ie(this,Ce).values()],s={};return t.forEach(t=>{pt(e,t.mutationKey)&&Object.assign(s,t.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Ie(this,Ee).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=mt(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Nt&&(t.enabled=!1),t}defaultMutationOptions(e){return(null==e?void 0:e._defaulted)?e:{...Ie(this,Ee).mutations,...(null==e?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Ie(this,Ae).clear(),Ie(this,Se).clear()}},Ae=new WeakMap,Se=new WeakMap,Ee=new WeakMap,Te=new WeakMap,Ce=new WeakMap,Oe=new WeakMap,De=new WeakMap,Me=new WeakMap,Pe),ts=qe.createContext(void 0),ss=e=>{const t=qe.useContext(ts);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},as=({client:e,children:t})=>(qe.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),Xe.jsx(ts.Provider,{value:e,children:t})),rs=qe.createContext(!1);rs.Provider;var is=qe.createContext(function(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}()),ls=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function ns(e,t,s){var a,r,i,l;const n=qe.useContext(rs),o=qe.useContext(is),d=ss(),c=d.defaultQueryOptions(e);null==(r=null==(a=d.getDefaultOptions().queries)?void 0:a._experimental_beforeQuery)||r.call(a,c);const u=d.getQueryCache().get(c.queryHash);c._optimisticResults=n?"isRestoring":"optimistic",(e=>{if(e.suspense){const t=1e3,s=e=>"static"===e?e:Math.max(e??t,t),a=e.staleTime;e.staleTime="function"==typeof a?(...e)=>s(a(...e)):s(a),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,t))}})(c),((e,t,s)=>{const a=(null==s?void 0:s.state.error)&&"function"==typeof e.throwOnError?St(e.throwOnError,[s.state.error,s]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||a)&&(t.isReset()||(e.retryOnMount=!1))})(c,o,u),(e=>{qe.useEffect(()=>{e.clearReset()},[e])})(o);const m=!d.getQueryCache().get(c.queryHash),[h]=qe.useState(()=>new t(d,c)),p=h.getOptimisticResult(c),x=!n&&!1!==e.subscribed;if(qe.useSyncExternalStore(qe.useCallback(e=>{const t=x?h.subscribe(Ot.batchCalls(e)):it;return h.updateResult(),t},[h,x]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),qe.useEffect(()=>{h.setOptions(c)},[c,h]),((e,t)=>(null==e?void 0:e.suspense)&&t.isPending)(c,p))throw ls(c,h,o);if((({result:e,errorResetBoundary:t,throwOnError:s,query:a,suspense:r})=>e.isError&&!t.isReset()&&!e.isFetching&&a&&(r&&void 0===e.data||St(s,[e.error,a])))({result:p,errorResetBoundary:o,throwOnError:c.throwOnError,query:u,suspense:c.suspense}))throw p.error;if(null==(l=null==(i=d.getDefaultOptions().queries)?void 0:i._experimental_afterQuery)||l.call(i,c,p),c.experimental_prefetchInRender&&!rt&&((e,t)=>e.isLoading&&e.isFetching&&!t)(p,n)){const e=m?ls(c,h,o):null==u?void 0:u.promise;null==e||e.catch(it).finally(()=>{h.updateResult()})}return c.notifyOnChangeProps?p:h.trackResult(p)}function os(e,t){return ns(e,$t)}function ds(e,t){const s=ss(),[a]=qe.useState(()=>new Xt(s,e));qe.useEffect(()=>{a.setOptions(e)},[a,e]);const r=qe.useSyncExternalStore(qe.useCallback(e=>a.subscribe(Ot.batchCalls(e)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),i=qe.useCallback((e,t)=>{a.mutate(e,t).catch(it)},[a]);if(r.error&&St(a.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:i,mutateAsync:r.mutate}}var cs=function(){return null},us=(e=>(e.ADMIN="ADMIN",e.EMPLOYEE="EMPLOYEE",e))(us||{}),ms=(e=>(e.PENDENTE="PENDENTE",e.EM_PROGRESSO="EM_PROGRESSO",e.TERMINADO="TERMINADO",e.FECHADO="FECHADO",e.ATRASADA="ATRASADA",e))(ms||{});const hs=String("http://localhost:8080").replace(/\/+$/,"");let ps=null;var xs=(e=>(e.ADMIN="ADMIN",e.EMPLOYEE="EMPLOYEE",e.MANAGER="MANAGER",e.GUEST="GUEST",e))(xs||{});const fs=e=>{ps=e,e?sessionStorage.setItem("gestora_api_token",e):sessionStorage.removeItem("gestora_api_token")},bs=()=>{const e={"Content-Type":"application/json"},t=(ps||(ps=sessionStorage.getItem("gestora_api_token")),ps);return t&&(e.Authorization=`Bearer ${t}`),e};async function vs(e){const t=e.headers.get("content-type")||"",s=await e.text();let a=s;try{s&&(t.includes("application/json")||s.startsWith("{"))&&(a=JSON.parse(s))}catch{a=s||null}if(!e.ok){const t=a&&(a.message||a.error||a.detail)||"string"==typeof a&&a||e.statusText||`HTTP ${e.status}`;throw new Error(t)}return a}const gs=async(e,t)=>{const s=`${hs}/auth/login`,a=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),r=await vs(a);return(null==r?void 0:r.token)?fs(r.token):(null==r?void 0:r.jwt)&&fs(r.jwt),r},ys=async(e,t,s,a)=>{const r=await fetch(`${hs}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,name:t,password:s,phone:a||""})}),i=await vs(r);return(null==i?void 0:i.token)?fs(i.token):(null==i?void 0:i.jwt)&&fs(i.jwt),i},ks=async()=>{const e=await fetch(`${hs}/auth/me`,{method:"GET",headers:bs()});return 404===e.status||401===e.status?null:vs(e)},ws=async e=>vs(await fetch(`${hs}/auth/validate-setup-token/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}})),js=async(e,t,s)=>vs(await fetch(`${hs}/auth/setup-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,password:t,confirmPassword:s})})),Ns=async e=>{const t=`${hs}/auth/forgot-password`;try{const s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});return await vs(s)}catch(s){throw s}},As=async()=>vs(await fetch(`${hs}/tasks/my-tasks`,{method:"GET",headers:bs()})),Ss=async(e,t)=>vs(await fetch(`${hs}/tasks/${e}`,{method:"PUT",headers:bs(),body:JSON.stringify(t)})),Es=async e=>vs(await fetch(`${hs}/tasks/${e}`,{method:"DELETE",headers:bs()})),Ts=async(e,t)=>vs(await fetch(`${hs}/tasks/${e}/status`,{method:"PATCH",headers:bs(),body:JSON.stringify({status:t})})),Cs=async()=>vs(await fetch(`${hs}/admin/tasks`,{method:"GET",headers:bs()})),Os=async e=>{const t={...e,responsibles:e.responsibles.map(e=>"string"==typeof e?parseInt(e,10):e).filter(e=>!isNaN(e))};return vs(await fetch(`${hs}/admin/tasks`,{method:"POST",headers:bs(),body:JSON.stringify(t)}))},Ds=async()=>vs(await fetch(`${hs}/admin/users`,{method:"GET",headers:bs()})),Ms=async e=>vs(await fetch(`${hs}/admin/users`,{method:"POST",headers:bs(),body:JSON.stringify({name:e.name,email:e.email,phone:e.phone||"",role:e.role||"USER"})})),Ps=async(e,t)=>vs(await fetch(`${hs}/admin/users/${e}`,{method:"PUT",headers:bs(),body:JSON.stringify(t)})),Rs=async e=>vs(await fetch(`${hs}/admin/users/${e}`,{method:"DELETE",headers:bs()})),Is=async(e,t)=>vs(await fetch(`${hs}/admin/users/${e}/role?role=${encodeURIComponent(t)}`,{method:"PATCH",headers:bs()})),Us=async()=>vs(await fetch(`${hs}/users`,{method:"GET",headers:bs()})),zs=async(e,t)=>vs(await fetch(`${hs}/users/${e}`,{method:"PUT",headers:bs(),body:JSON.stringify(t)})),Fs=async(e,t,s)=>vs(await fetch(`${hs}/users/${e}/password`,{method:"PATCH",headers:bs(),body:JSON.stringify({password:t,oldPassword:s})})),Ls=async(e,t)=>vs(await fetch(`${hs}/tasks/${e}/comments`,{method:"POST",headers:bs(),body:JSON.stringify({text:t})})),qs=e=>({id:String(e.id||e.userId||""),email:e.email||"",name:e.name||e.username||"Utilizador",phone:e.phone||null,role:"ADMIN"===e.role?"ADMIN":"EMPLOYEE",position:e.position||e.role||"",department:e.department||"",avatar:e.avatar||null,mustChangePassword:e.mustChangePassword??!1,createdAt:e.createdAt||(new Date).toISOString(),updatedAt:e.updatedAt||(new Date).toISOString()}),$s=e=>{var t,s,a;return{id:String(e.id||""),text:e.text||e.content||"",userId:String(e.userId||(null==(t=e.user)?void 0:t.id)||e.authorId||""),userName:e.userName||(null==(s=e.user)?void 0:s.name)||e.authorName||"AnÃ´nimo",timestamp:e.timestamp||e.createdAt||(new Date).toISOString(),taskId:String(e.taskId||(null==(a=e.task)?void 0:a.id)||"")}},_s=(e,t,s)=>`[${(new Date).toLocaleString("pt-PT",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}] [${e}] [${t}] ${s}`,Ws={debug:(e,t,s)=>{},info:(e,t,s)=>{_s("INFO",e,t)},warn:(e,t,s)=>{_s("WARN",e,t)},error:(e,t,s)=>{_s("ERROR",e,t)},apiCall:(e,t)=>{},apiSuccess:(e,t,s)=>{Ws.info("API",`${e} ${t} ${s||"200"} OK`)},apiError:(e,t,s)=>{Ws.error("API",`${e} ${t} Falhou`,s)}},Qs={all:["tasks"],lists:()=>[...Qs.all,"list"],list:e=>[...Qs.lists(),e]},Vs={all:["users"],lists:()=>[...Vs.all,"list"]},Gs=[ms.PENDENTE,ms.EM_PROGRESSO,ms.TERMINADO,ms.FECHADO],Hs=e=>{const t=Gs.indexOf(e);return-1===t||t===Gs.length-1?e:Gs[t+1]},Ks=e=>{const t=Gs.indexOf(e);return t<=0?e:Gs[t-1]},Ys=qe.createContext(void 0),Bs=({children:e})=>{const t=ss(),[s,a]=qe.useState(null),[r,i]=qe.useState([]),[l,n]=qe.useState([]),[o,d]=qe.useState("login"),[c,u]=qe.useState("pt"),[m,h]=qe.useState("light"),[p,x]=qe.useState([]),[f,b]=qe.useState("dashboard"),[v,g]=qe.useState([]),[y,k]=qe.useState(!1),[w,j]=qe.useState(null),[N,A]=qe.useState(null),[S,E]=qe.useState(""),[T,C]=qe.useState("all"),O=qe.useRef(null),D=qe.useRef(new Map),{data:M=[],refetch:P}=os({queryKey:Qs.list({}),queryFn:async()=>{if(!s)return[];try{const e=(null==s?void 0:s.role)===us.ADMIN?await Cs():await As();return(Array.isArray(e)?e:e.data||e.tasks||[]).map(e=>{return t=e,{id:String(t.id||""),title:t.title||"",description:t.description||"",status:t.status||"PENDENTE",priority:t.priority||"MEDIUM",responsibleId:String(t.responsibleId||t.responsibles&&(null==(s=t.responsibles[0])?void 0:s.id)||""),responsibleName:t.responsibleName||t.responsibles&&(null==(a=t.responsibles[0])?void 0:a.name)||"",deliveryDate:t.endDate||t.deliveryDate||(new Date).toISOString(),startDate:t.createAt||t.startDate||(new Date).toISOString(),intervenientes:Array.isArray(t.responsibles)?t.responsibles.slice(1).map(e=>String(e.id)):t.intervenientes||[],comments:Array.isArray(t.comments)?t.comments.map($s):[],createdAt:t.createdAt||t.createAt||(new Date).toISOString(),updatedAt:t.updatedAt||(new Date).toISOString(),deadlineValue:t.daysToFinish||1,deadlineType:"days"};var t,s,a})}catch(e){return[]}},refetchInterval:1e3,staleTime:1e3,enabled:!!s}),{data:R=[],refetch:I}=os({queryKey:Vs.lists(),queryFn:async()=>{if(!s||s.role!==us.ADMIN)return[];try{const e=await Ds();return(Array.isArray(e)?e:e.data||e.users||[]).map(e=>qs(e))}catch(e){return[]}},enabled:(null==s?void 0:s.role)===us.ADMIN,refetchInterval:6e4}),U=ds({mutationFn:async e=>{const t=Hs(e.status);return Ts(e.id,t)},onMutate:async e=>{await t.cancelQueries({queryKey:Qs.lists()});const s=t.getQueryData(Qs.lists());return t.setQueryData(Qs.lists(),t=>Array.isArray(t)?t.map(t=>t.id===e.id?{...t,status:Hs(t.status)}:t):t),{previousTasks:s}},onError:(e,a,r)=>{t.setQueryData(Qs.lists(),null==r?void 0:r.previousTasks),_(s.id,"Erro ao avanÃ§ar status","error")},onSuccess:(e,t)=>{_(s.id,"Tarefa avanÃ§ada com sucesso","success"),W({userId:s.id,userName:s.name,action:"status_changed",entityType:"task",entityId:t.id,entityTitle:t.title,fromStatus:t.status,toStatus:Hs(t.status)})}}),z=ds({mutationFn:async e=>{const t=Ks(e.status);return Ts(e.id,t)},onMutate:async e=>{await t.cancelQueries({queryKey:Qs.lists()});const s=t.getQueryData(Qs.lists());return t.setQueryData(Qs.lists(),t=>Array.isArray(t)?t.map(t=>t.id===e.id?{...t,status:Ks(t.status)}:t):t),{previousTasks:s}},onError:(e,a,r)=>{t.setQueryData(Qs.lists(),null==r?void 0:r.previousTasks),_(s.id,"Erro ao recuar status","error")},onSuccess:(e,t)=>{_(s.id,"Tarefa recuada com sucesso","info")}}),F=ds({mutationFn:e=>Es(e),onMutate:async e=>{await t.cancelQueries({queryKey:Qs.lists()});const s=t.getQueryData(Qs.lists());return t.setQueryData(Qs.lists(),t=>Array.isArray(t)?t.filter(t=>t.id!==e):t),{previousTasks:s}},onError:(e,a,r)=>{t.setQueryData(Qs.lists(),null==r?void 0:r.previousTasks),_(s.id,"Erro ao deletar tarefa","error")},onSuccess:(e,t)=>{_(s.id,"Tarefa deletada com sucesso","success")}}),L=ds({mutationFn:({taskId:e,text:t})=>Ls(e,t),onSuccess:async(e,{taskId:a,text:r})=>{await t.invalidateQueries({queryKey:Qs.lists()}),_(s.id,"ComentÃ¡rio adicionado","success")}});qe.useEffect(()=>{M.length>0&&i(M)},[M]),qe.useEffect(()=>{R.length>0&&n(R)},[R]);const q=qe.useMemo(()=>{let e=r;return S&&(e=e.filter(e=>e.title.toLowerCase().includes(S.toLowerCase()))),"all"!==T&&(e=e.filter(e=>e.status===T)),(null==s?void 0:s.role)===us.EMPLOYEE&&(e=e.filter(e=>{var t;return e.responsibleId===s.id||(null==(t=e.intervenientes)?void 0:t.includes(s.id))})),e},[r,S,T,s]),$=async(e,t,s)=>{k(!0);try{const r=await gs(e,t),i=r.token||r.jwt;if(!i)throw new Error("Resposta de login sem token.");fs(i),s&&localStorage.setItem("gestora_remember_email",e);const l=r.user||r,n={...l,id:(null==l?void 0:l.id)??(null==l?void 0:l.userId),email:(null==l?void 0:l.email)??e,name:(null==l?void 0:l.name)??(null==l?void 0:l.username),role:(null==l?void 0:l.role)??us.EMPLOYEE},o=qs(n);a(o),await P(),o.role===us.ADMIN&&await I(),o.mustChangePassword?(d("app"),b("profile")):d("app")}catch(r){throw fs(null),a(null),r}finally{k(!1)}},_=async(e,t,s="info")=>{const a=Date.now(),r=`${e}|${s}|${t}`,i=D.current.get(r)||0;if(a-i<5e3)return;D.current.set(r,a);const l={id:Math.random().toString(36).substr(2,9),userId:e,message:t,type:s,timestamp:(new Date).toISOString(),isRead:!1};x(r=>r.some(r=>r.userId===e&&r.message===t&&r.type===s&&Math.abs(new Date(r.timestamp).getTime()-a)<1e4)?r:[l,...r])},W=e=>{const t={...e,id:"A-"+Math.random().toString(36).substr(2,9),timestamp:(new Date).toISOString()};g(e=>{if(e.some(e=>e.userId===t.userId&&e.action===t.action&&e.entityId===t.entityId&&e.fromStatus===t.fromStatus&&e.toStatus===t.toStatus))return e;const s=[t,...e].slice(0,200);return localStorage.setItem("gestora_activities",JSON.stringify(s)),s});const s="created"===e.action?`Criou tarefa: ${e.entityTitle||e.entityId}`:"updated"===e.action?`Atualizou tarefa: ${e.entityTitle||e.entityId}`:"deleted"===e.action?`Eliminou tarefa: ${e.entityTitle||e.entityId}`:"status_changed"===e.action?`Mudou estado: ${e.entityTitle||e.entityId} (${e.fromStatus} â ${e.toStatus})`:"commented"===e.action?`Comentou na tarefa: ${e.entityTitle||e.entityId}`:`Atividade: ${e.entityTitle||e.entityId}`;l.filter(e=>e.role===us.ADMIN).forEach(e=>{_(e.id,s,"info")})},Q=async e=>{const t=e??s;if(t)try{await P(),t.role===us.ADMIN&&await I()}catch(a){}},V=(e,t)=>{localStorage.setItem(`gestora_avatar_${e}`,t),n(s=>s.map(s=>s.id===e?{...s,avatar:t}:s))};qe.useEffect(()=>{"dark"===m?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[m]),qe.useEffect(()=>{const e=sessionStorage.getItem("gestora_api_token");e?(fs(e),(async()=>{try{const e=await ks();if(!e)return fs(null),a(null),void d("login");const t={...e,id:(null==e?void 0:e.id)??(null==e?void 0:e.userId),email:null==e?void 0:e.email,name:(null==e?void 0:e.name)??(null==e?void 0:e.username),role:(null==e?void 0:e.role)??us.EMPLOYEE},s=qs(t);a(s),await Q(s),s.mustChangePassword?(d("app"),b("profile")):d("app")}catch(e){fs(null),a(null),d("login")}})()):(a(null),d("login"))},[]);const G={user:s,setUser:a,tasks:r,setTasks:i,users:l,setUsers:n,notifications:p,setNotifications:x,systemActivities:v,setSystemActivities:g,view:o,setView:d,activeTab:f,setActiveTab:b,lang:c,setLang:u,theme:m,setTheme:h,isLoading:y,setIsLoading:k,login:$,logout:()=>{fs(null),a(null),i([]),n([]),g([]),x([]),d("login"),b("dashboard"),localStorage.removeItem("gestora_remember_email"),t.clear()},register:async(e,t,s)=>{k(!0);try{const a=await ys(e,t,s);return setTimeout(async()=>{try{await $(e,s)}catch(t){}},2e3),a}catch(a){throw new Error(a.message||"Erro ao criar conta. Tente novamente.")}finally{k(!1)}},validateSetupToken:async e=>{try{return await ws(e)}catch(t){throw new Error(t.message||"Erro ao validar token.")}},setupPassword:async(e,t,s)=>{try{return await js(e,t,s)}catch(a){throw new Error(a.message||"Erro ao definir senha.")}},validateResetToken:async e=>{try{const t=await fetch(`http://localhost:8080/auth/validate-token/${e}`);return await t.json()}catch(t){throw new Error(t.message||"Erro ao validar token.")}},resetPassword:async(e,t,s)=>{try{const a=await fetch("http://localhost:8080/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,password:t,confirmPassword:s})}),r=await a.json();if(!a.ok)throw new Error(r.error);return r}catch(a){throw new Error(a.message||"Erro ao redefinir senha.")}},createTask:async e=>{try{const t=e.responsibles.map(e=>Number(e)),a={title:e.title,description:e.description,daysToFinish:e.daysToFinish,status:"PENDENTE",responsibles:t},r=await Os(a);if(!r||!r.task)throw new Error("Resposta invÃ¡lida da API.");await P(),W({userId:s.id,userName:s.name,action:"created",entityType:"task",entityId:r.task.id,entityTitle:e.title}),_(s.id,"Tarefa criada com sucesso.","success")}catch(t){throw Ws.error("Task","Erro ao criar tarefa na API",t),t}},updateTask:async(e,t)=>{try{const a=r.find(t=>t.id===e);await Ss(e,{...a,...t});await P(),_(s.id,"Tarefa atualizada com sucesso.","success"),W({userId:s.id,userName:s.name,action:"updated",entityType:"task",entityId:e,entityTitle:t.title})}catch(a){throw Ws.warn("Task","Erro ao atualizar na API",a),a}},deleteTask:async e=>{try{await Es(e.id),await P(),W({userId:s.id,userName:s.name,action:"deleted",entityType:"task",entityId:e.id,entityTitle:e.title}),_(s.id,`Tarefa "${e.title}" eliminada com sucesso.`,"success")}catch(t){throw Ws.warn("Task","Erro ao deletar na API",t),_(s.id,"NÃ£o foi possÃ­vel eliminar a tarefa na API.","error"),t}},handleAdvanceStatus:async e=>{var t;const a=e.responsibleId===(null==s?void 0:s.id)||(null==(t=e.intervenientes)?void 0:t.includes(null==s?void 0:s.id));(null==s?void 0:s.role)!==us.EMPLOYEE||a?e.status!==ms.TERMINADO||(null==s?void 0:s.role)===us.ADMIN?U.mutate(e):_(s.id,"Apenas administradores podem avanÃ§ar tarefas finalizadas.","error"):_(s.id,"VocÃª nÃ£o Ã© membro desta tarefa.","error")},handleRegressStatus:async e=>{var t;const a=e.responsibleId===(null==s?void 0:s.id)||(null==(t=e.intervenientes)?void 0:t.includes(null==s?void 0:s.id));(null==s?void 0:s.role)!==us.EMPLOYEE||a?e.status!==ms.TERMINADO||(null==s?void 0:s.role)===us.ADMIN?z.mutate(e):_(s.id,"Apenas administradores podem recuar tarefas finalizadas.","error"):_(s.id,"VocÃª nÃ£o tem permissÃ£o para recuar esta tarefa.","error")},handleDeleteTask:async e=>{window.confirm(`Deseja eliminar a tarefa "${e.title}"?`)&&F.mutate(e.id)},addComment:async(e,t)=>{s&&L.mutate({taskId:e,text:t})},filterTasks:e=>{void 0!==e.search&&E(e.search),void 0!==e.status&&C(e.status)},filteredTasks:q,loadUsers:async()=>{(null==s?void 0:s.role)===us.ADMIN&&await I()},createUser:async e=>{var t,a,r,i;try{await Ms({name:e.name,email:e.email,role:e.role===us.ADMIN?"ADMIN":"USER",phone:e.phone||""});await I(),l.filter(e=>e.role===us.ADMIN).forEach(t=>{_(t.id,`Novo utilizador criado: ${e.name} (${e.email})`,"info")}),_(s.id,`Utilizador ${e.name} criado com sucesso.`,"success")}catch(n){if((null==(t=n.message)?void 0:t.includes("409"))||(null==(a=n.message)?void 0:a.includes("Conflict"))||(null==(r=n.message)?void 0:r.toLowerCase().includes("email"))||(null==(i=n.message)?void 0:i.toLowerCase().includes("duplicate")))throw new Error("Este email jÃ¡ estÃ¡ cadastrado no sistema. Use um email diferente.");throw n}},updateUser:async(e,t)=>{try{await zs(e,t),await I(),l.filter(e=>e.role===us.ADMIN).forEach(e=>{_(e.id,`Utilizador atualizado: ${t.name} (${t.email})`,"info")}),_(s.id,`Utilizador ${t.name} atualizado com sucesso.`,"success")}catch(a){throw Ws.warn("User","Erro ao atualizar na API",a),a}},deleteUser:async e=>{const t=l.find(t=>t.id===e);if(t&&window.confirm(`Tem certeza que deseja eliminar o utilizador "${t.name}"?`))try{await Rs(e),await I(),_(s.id,`Utilizador ${t.name} eliminado com sucesso.`,"success")}catch(a){throw Ws.warn("User","Erro ao eliminar na API",a),_(s.id,`NÃ£o foi possÃ­vel eliminar ${t.name} na API.`,"error"),a}},addNotification:_,markAllNotificationsAsRead:()=>{x(e=>e.map(e=>e.userId===(null==s?void 0:s.id)?{...e,isRead:!0}:e))},addSystemActivity:W,loadDataFromAPI:Q,getAvatarUrl:e=>"undefined"==typeof localStorage?null:localStorage.getItem(`gestora_avatar_${e.id}`),saveAvatar:V,openAvatarUpload:e=>{A(e),setTimeout(()=>{var e;return null==(e=O.current)?void 0:e.click()},0)}};return Xe.jsxs(Ys.Provider,{value:G,children:[e,Xe.jsx("input",{ref:O,type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(s&&N){const e=new FileReader;e.onload=()=>{V(N,e.result),A(null)},e.readAsDataURL(s)}e.target.value=""}})]})},Js=(...e)=>e.filter((e,t,s)=>Boolean(e)&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),Xs=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)};
/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var Zs={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1},ta=qe.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:r="",children:i,iconNode:l,...n},o)=>qe.createElement("svg",{ref:o,...Zs,width:t,height:t,stroke:e,strokeWidth:a?24*Number(s)/Number(t):s,className:Js("lucide",r),...!i&&!ea(n)&&{"aria-hidden":"true"},...n},[...l.map(([e,t])=>qe.createElement(e,t)),...Array.isArray(i)?i:[i]])),sa=(e,t)=>{const s=qe.forwardRef(({className:s,...a},r)=>{return qe.createElement(ta,{ref:r,iconNode:t,className:Js(`lucide-${i=Xs(e),i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,s),...a});var i});return s.displayName=Xs(e),s},aa=sa("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),ra=sa("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),ia=sa("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),la=sa("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),na=sa("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),oa=sa("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),da=sa("chart-no-axes-column",[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]]),ca=sa("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),ua=sa("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),ma=sa("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),ha=sa("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),pa=sa("circle-chevron-left",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m14 16-4-4 4-4",key:"ojs7w8"}]]),xa=sa("clipboard-list",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),fa=sa("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),ba=sa("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),va=sa("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),ga=sa("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),ya=sa("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),ka=sa("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]),wa=sa("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),ja=sa("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),Na=sa("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),Aa=sa("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Sa=sa("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),Ea=sa("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Ta=sa("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),Ca=sa("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Oa=sa("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Da=sa("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Ma=sa("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),Pa=sa("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Ra=sa("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Ia=sa("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ua=sa("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),za=sa("workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]),Fa=sa("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),La=()=>{const e=qe.useContext(Ys);if(!e)throw new Error("useAuth must be used within AppProvider");return{user:e.user,setUser:e.setUser,login:e.login,logout:e.logout,register:e.register,isLoading:e.isLoading,setIsLoading:e.setIsLoading,validateSetupToken:e.validateSetupToken,setupPassword:e.setupPassword,validateResetToken:e.validateResetToken,resetPassword:e.resetPassword}},qa=()=>{const e=qe.useContext(Ys);if(!e)throw new Error("useNavigation must be used within AppProvider");return{view:e.view,setView:e.setView,activeTab:e.activeTab,setActiveTab:e.setActiveTab}},$a={primary:"bg-[#10b981] hover:bg-[#059669] text-white shadow-xl shadow-emerald-500/20",secondary:"bg-white border border-slate-200 text-slate-700 hover:bg-slate-50",outline:"bg-transparent border-2 border-[#10b981] text-[#10b981] hover:bg-emerald-50",danger:"bg-rose-500 hover:bg-rose-600 text-white",ghost:"bg-transparent text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-800"},_a=({children:e,onClick:t,variant:s="primary",className:a="",type:r="button",disabled:i=!1})=>Xe.jsx("button",{type:r,disabled:i,onClick:t,className:`px-8 py-4 rounded-2xl font-bold text-[14px] transition-all flex items-center justify-center gap-3 disabled:opacity-50 ${$a[s]} ${a}`,children:e}),Wa=({onClose:e})=>{const[t,s]=qe.useState(""),[a,r]=qe.useState(null),[i,l]=qe.useState(!1);return Xe.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:Xe.jsxs("div",{className:"bg-white rounded-2xl p-6 sm:p-8 max-w-md w-full shadow-2xl",children:[Xe.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Xe.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Recuperar Senha"}),Xe.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-600",children:Xe.jsx(Fa,{size:24})})]}),Xe.jsx("p",{className:"text-sm text-slate-600 mb-6",children:"Digite o seu email para receber um link de recuperaÃ§Ã£o de senha."}),a&&Xe.jsx("div",{className:"mb-4 p-3 rounded-lg text-sm "+(a.includes("â")?"bg-emerald-50 text-emerald-700 border border-emerald-200":a.includes("â")?"bg-rose-50 text-rose-700 border border-rose-200":"bg-blue-50 text-blue-700 border border-blue-200"),children:a}),Xe.jsxs("div",{className:"space-y-4",children:[Xe.jsxs("div",{children:[Xe.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:"Email"}),Xe.jsx("input",{type:"email",value:t,onChange:e=>s(e.target.value),placeholder:"nome@empresa.com",className:"w-full px-4 py-2.5 border border-slate-300 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",disabled:i})]}),Xe.jsx(_a,{onClick:async()=>{var s,a,i;if(t)if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)){r("Processando..."),l(!0);try{const s=await Ns(t);s&&s.message?r(`â ${s.message}`):r(`â SolicitaÃ§Ã£o enviada com sucesso! Se o email ${t} estiver cadastrado, vocÃª receberÃ¡ instruÃ§Ãµes em instantes.`),setTimeout(()=>{e()},5e3)}catch(n){(null==(s=n.message)?void 0:s.includes("404"))?r("â Endpoint de recuperaÃ§Ã£o nÃ£o encontrado. Contacte o administrador."):(null==(a=n.message)?void 0:a.includes("network"))||(null==(i=n.message)?void 0:i.includes("Failed to fetch"))?r("â Erro de conexÃ£o. Verifique sua internet e tente novamente."):r(`â ${n.message||"Erro ao solicitar recuperaÃ§Ã£o de senha."}`)}finally{l(!1)}}else r("Por favor, insira um email vÃ¡lido.");else r("Por favor, insira o seu email.")},disabled:i,className:"w-full py-3",children:i?"Enviando...":"Enviar Link de RecuperaÃ§Ã£o"}),Xe.jsx("button",{onClick:e,className:"w-full py-2 text-slate-500 hover:text-slate-700 text-sm",children:"Cancelar"})]})]})})},Qa=({onClose:e})=>{const{register:t}=La(),[s,a]=qe.useState(!1),[r,i]=qe.useState(!1),[l,n]=qe.useState(null),[o,d]=qe.useState({name:"",email:"",password:"",confirmPassword:""}),c=e=>{const{name:t,value:s}=e.target;d(e=>({...e,[t]:s})),l&&n(null)};return Xe.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:Xe.jsxs("div",{className:"bg-white rounded-2xl p-6 sm:p-8 max-w-md w-full shadow-2xl",children:[Xe.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Xe.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"Criar Nova Conta"}),Xe.jsx("button",{onClick:()=>{d({name:"",email:"",password:"",confirmPassword:""}),n(null),e()},className:"text-slate-400 hover:text-slate-600",children:Xe.jsx(Fa,{size:24})})]}),r?Xe.jsxs("div",{className:"text-center py-8",children:[Xe.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:Xe.jsx(ha,{size:32,className:"text-emerald-600"})}),Xe.jsx("h4",{className:"text-lg font-bold text-slate-900 mb-2",children:"Conta Criada!"}),Xe.jsx("p",{className:"text-slate-600",children:"A redirecionar para o sistema..."})]}):Xe.jsxs("form",{onSubmit:async s=>{if(s.preventDefault(),n(null),o.name.trim()?o.email.trim()?!o.password||o.password.length<6?(n("A senha deve ter pelo menos 6 caracteres."),0):o.password===o.confirmPassword||(n("As senhas nÃ£o coincidem."),0):(n("Por favor, preencha o email."),0):(n("Por favor, preencha o nome."),0)){a(!0);try{await t(o.email,o.name,o.password),i(!0),setTimeout(()=>{e()},2e3)}catch(r){n(r.message||"Erro ao criar conta. Tente novamente.")}finally{a(!1)}}},className:"space-y-4",children:[l&&Xe.jsx("div",{className:"p-3 bg-rose-50 border border-rose-200 rounded-lg",children:Xe.jsx("p",{className:"text-rose-700 text-sm",children:l})}),Xe.jsxs("div",{children:[Xe.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:["Nome Completo ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsx("input",{type:"text",name:"name",value:o.name,onChange:c,placeholder:"Seu nome completo",className:"w-full px-4 py-2.5 border border-slate-300 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",required:!0})]}),Xe.jsxs("div",{children:[Xe.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:["Email ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsx("input",{type:"email",name:"email",value:o.email,onChange:c,placeholder:"nome@empresa.com",className:"w-full px-4 py-2.5 border border-slate-300 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",required:!0})]}),Xe.jsxs("div",{children:[Xe.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:["Senha ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsx("input",{type:"password",name:"password",value:o.password,onChange:c,placeholder:"MÃ­nimo 6 caracteres",className:"w-full px-4 py-2.5 border border-slate-300 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",required:!0,minLength:6})]}),Xe.jsxs("div",{children:[Xe.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1.5",children:["Confirmar Senha ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsx("input",{type:"password",name:"confirmPassword",value:o.confirmPassword,onChange:c,placeholder:"Confirme sua senha",className:"w-full px-4 py-2.5 border border-slate-300 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",required:!0})]}),Xe.jsx(_a,{type:"submit",disabled:s,className:"w-full py-3",children:s?Xe.jsxs(Xe.Fragment,{children:[Xe.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"A criar conta..."]}):"Criar Conta"}),Xe.jsx("button",{type:"button",onClick:()=>{d({name:"",email:"",password:"",confirmPassword:""}),n(null),e()},className:"w-full py-2 text-slate-500 hover:text-slate-700 text-sm",children:"Cancelar"})]})]})})},Va=()=>{const{login:e,isLoading:t,setIsLoading:s}=La(),{setView:a}=qa(),[r,i]=qe.useState(null),[l,n]=qe.useState(!1),[o,d]=qe.useState(!1),[c,u]=qe.useState(!1),[m,h]=qe.useState({email:"",password:""});qe.useEffect(()=>{const e=localStorage.getItem("gestora_remember_email");e&&(h(t=>({...t,email:e})),n(!0))},[]);const p=e=>{const{name:t,value:s}=e.target;h(e=>({...e,[t]:s})),r&&i(null)};return Xe.jsxs("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4 sm:p-6 font-sans",children:[Xe.jsxs("div",{className:"w-full max-w-md",children:[Xe.jsxs("div",{className:"text-center mb-8 sm:mb-10",children:[Xe.jsx("div",{className:"inline-flex p-3 sm:p-4 bg-emerald-500 rounded-2xl shadow-lg mb-4 sm:mb-6",children:Xe.jsx(za,{size:28,className:"sm:w-9 sm:h-9 text-white"})}),Xe.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-slate-900 tracking-tight mb-2",children:"GESTORA"}),Xe.jsx("p",{className:"text-xs sm:text-sm text-slate-500 font-medium",children:"Professional Workflow Management"})]}),Xe.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl p-6 sm:p-8 shadow-lg border border-slate-200",children:[Xe.jsx("h2",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-2",children:"Acesso ao Sistema"}),Xe.jsx("p",{className:"text-slate-500 text-xs sm:text-sm mb-6 sm:mb-8",children:"Entre com suas credenciais corporativas"}),r&&Xe.jsx("div",{className:"mb-6 p-3 bg-rose-50 border border-rose-200 rounded-lg",children:Xe.jsxs("div",{className:"flex items-start gap-2",children:[Xe.jsx(Pa,{className:"text-rose-500 mt-0.5 flex-shrink-0",size:16}),Xe.jsx("p",{className:"text-rose-700 text-sm",children:r})]})}),Xe.jsxs("form",{className:"space-y-4 sm:space-y-6",onSubmit:async t=>{if(t.preventDefault(),i(null),m.email.trim()?m.password.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m.email)||(i("Por favor, insira um email vÃ¡lido."),0):(i("Por favor, preencha o campo de senha."),0):(i("Por favor, preencha o campo de email."),0)){s(!0);try{await e(m.email,m.password,l)}catch(a){i((e=>{var t,s,a,r;if(!e)return"Ocorreu um erro desconhecido. Tente novamente.";const i=(null==(s=null==(t=null==e?void 0:e.response)?void 0:t.data)?void 0:s.message)||(null==(r=null==(a=null==e?void 0:e.response)?void 0:a.data)?void 0:r.error)||(null==e?void 0:e.message)||(null==e?void 0:e.toString())||"",l=i.toLowerCase();if(l.includes("bad credentials")||l.includes("unauthorized")||l.includes("forbidden")||l.includes("senha")||l.includes("password")||l.includes("credenciais")||l.includes("invalid credentials")||l.includes("invalid email or password")||l.includes("email ou senha invÃ¡lidos"))return"Email ou palavra-passe incorretos.";if(l.includes("user not found")||l.includes("utilizador nÃ£o encontrado")||l.includes("email nÃ£o encontrado")||l.includes("email not found")||l.includes("no user found"))return"Este email nÃ£o estÃ¡ registado no sistema.";if(l.includes("locked")||l.includes("blocked")||l.includes("disabled")||l.includes("desativado")||l.includes("bloqueado"))return"A sua conta estÃ¡ bloqueada. Contacte o administrador.";if(l.includes("token")||l.includes("jwt")||l.includes("session expired")||l.includes("sessÃ£o expirada"))return l.includes("invalid")?"Token de autenticaÃ§Ã£o invÃ¡lido. FaÃ§a login novamente.":l.includes("expired")?"A sua sessÃ£o expirou. FaÃ§a login novamente.":"Erro de autenticaÃ§Ã£o. FaÃ§a login novamente.";if(l.includes("network")||l.includes("connection")||l.includes("internet")||l.includes("failed to fetch")||l.includes("econnrefused")||l.includes("econnreset")||l.includes("timeout")||l.includes("cors")||"NetworkError"===(null==e?void 0:e.name)||"ECONNREFUSED"===(null==e?void 0:e.code)||"ETIMEDOUT"===(null==e?void 0:e.code))return"NÃ£o foi possÃ­vel conectar ao servidor. Verifique a sua ligaÃ§Ã£o Ã  internet.";if(l.includes("too many requests")||l.includes("rate limit")||l.includes("many attempts")||429===(null==e?void 0:e.status))return"Demasiadas tentativas. Por favor, aguarde alguns minutos e tente novamente.";if(l.includes("internal server error")||l.includes("500")||500===(null==e?void 0:e.status)||502===(null==e?void 0:e.status)||503===(null==e?void 0:e.status))return"Erro no servidor. Por favor, tente novamente mais tarde.";if(l.includes("validation")||l.includes("valid")||l.includes("formato")||l.includes("invalid")){if(l.includes("email"))return"Por favor, insira um email vÃ¡lido.";if(l.includes("password")||l.includes("senha"))return"A senha deve ter pelo menos 6 caracteres."}return l.includes("email already exists")||l.includes("email jÃ¡ existe")||l.includes("duplicate")||l.includes("409")||l.includes("conflict")?"Este email jÃ¡ estÃ¡ registado. FaÃ§a login ou use outro email.":l.includes("password must")||l.includes("senha deve")?l.includes("6")?"A senha deve ter pelo menos 6 caracteres.":l.includes("uppercase")?"A senha deve conter pelo menos uma letra maiÃºscula.":l.includes("number")?"A senha deve conter pelo menos um nÃºmero.":l.includes("special")?"A senha deve conter pelo menos um caractere especial.":"A senha nÃ£o atende aos requisitos de seguranÃ§a.":l.includes("maintenance")||l.includes("manutenÃ§Ã£o")?"O sistema estÃ¡ em manutenÃ§Ã£o. Tente novamente mais tarde.":i&&!i.includes("[object")&&i.length<100?i:"Falha na autenticaÃ§Ã£o. Por favor, tente novamente."})(a))}finally{s(!1)}}},children:[Xe.jsxs("div",{className:"space-y-1.5",children:[Xe.jsxs("label",{className:"text-sm font-medium text-slate-700",children:["Email Corporativo ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsxs("div",{className:"relative",children:[Xe.jsx("input",{name:"email",type:"email",value:m.email,onChange:p,placeholder:"nome@empresa.com",className:`w-full pl-10 pr-4 py-2.5 sm:py-3 bg-white border ${r&&!m.email?"border-rose-300 focus:border-rose-500":"border-slate-300 focus:border-emerald-500"} rounded-xl focus:ring-2 focus:ring-emerald-500/20 text-slate-900 outline-none transition-all text-sm`,disabled:t,required:!0}),Xe.jsx(ya,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18})]})]}),Xe.jsxs("div",{className:"space-y-1.5",children:[Xe.jsxs("label",{className:"text-sm font-medium text-slate-700",children:["Senha ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsxs("div",{className:"relative",children:[Xe.jsx("input",{name:"password",type:"password",value:m.password,onChange:p,placeholder:"Digite sua senha",className:`w-full pl-10 pr-4 py-2.5 sm:py-3 bg-white border ${r&&!m.password?"border-rose-300 focus:border-rose-500":"border-slate-300 focus:border-emerald-500"} rounded-xl focus:ring-2 focus:ring-emerald-500/20 text-slate-900 outline-none transition-all text-sm`,disabled:t,required:!0}),Xe.jsx(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18})]})]}),Xe.jsxs("div",{className:"flex items-center justify-between",children:[Xe.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[Xe.jsx("input",{type:"checkbox",checked:l,onChange:()=>{n(!l),l?localStorage.removeItem("gestora_remember_email"):localStorage.setItem("gestora_remember_email",m.email)},className:"w-4 h-4 text-emerald-500 rounded border-slate-300 focus:ring-emerald-500/20",disabled:t}),Xe.jsx("span",{className:"text-sm text-slate-600",children:"Lembrar-me"})]}),Xe.jsx("button",{type:"button",onClick:()=>d(!0),className:"text-sm text-emerald-600 hover:text-emerald-700 font-medium disabled:text-slate-400",disabled:t,children:"Esqueceu a senha?"})]}),Xe.jsx(_a,{type:"submit",disabled:t,className:"w-full py-3 sm:py-3.5",children:t?Xe.jsxs(Xe.Fragment,{children:[Xe.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Autenticando..."]}):"Entrar no Sistema"})]}),Xe.jsxs("div",{className:"mt-6 sm:mt-8 pt-4 sm:pt-6 border-t border-slate-100 text-center",children:[Xe.jsx("p",{className:"text-sm text-slate-500",children:"NÃ£o tem uma conta?"}),Xe.jsxs("button",{onClick:()=>u(!0),disabled:t,className:"text-sm text-emerald-600 hover:text-emerald-700 font-medium disabled:text-slate-400 transition-colors flex items-center justify-center gap-2 mx-auto mt-2",children:[Xe.jsx(Ra,{size:16}),"Criar conta"]})]}),Xe.jsx("div",{className:"mt-6 sm:mt-8 pt-4 sm:pt-6 border-t border-slate-100 text-center",children:Xe.jsxs("button",{onClick:()=>a("landing"),disabled:t,className:"text-sm text-slate-500 hover:text-slate-700 disabled:text-slate-400 transition-colors flex items-center justify-center gap-2 mx-auto",children:[Xe.jsx(ma,{size:16}),"Voltar para o inÃ­cio"]})})]}),Xe.jsxs("div",{className:"mt-6 sm:mt-8 text-center",children:[Xe.jsx("p",{className:"text-xs text-slate-400",children:"Â© 2026 GESTORA â¢ Sistema de GestÃ£o de Tarefas"}),Xe.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:"Suporte: suporte@gestora.com"})]})]}),o&&Xe.jsx(Wa,{onClose:()=>d(!1)}),c&&Xe.jsx(Qa,{onClose:()=>u(!1)})]})},Ga=()=>{const{validateSetupToken:e,setupPassword:t}=La(),{setView:s}=qa(),[a,r]=qe.useState(null),[i,l]=qe.useState(null),[n,o]=qe.useState(null),[d,c]=qe.useState(!1),[u,m]=qe.useState(""),[h,p]=qe.useState(""),[x,f]=qe.useState(null),[b,v]=qe.useState(null),[g,y]=qe.useState(!0);qe.useEffect(()=>{const e=new URLSearchParams(window.location.search).get("token");e?(r(e),k(e)):(l(!1),f("Link invÃ¡lido ou incompleto."),y(!1))},[]);const k=async t=>{var s,a;try{y(!0);const r=await e(t);r.valid?(l(!0),o({name:(null==(s=r.user)?void 0:s.name)||"",email:(null==(a=r.user)?void 0:a.email)||""})):(l(!1),f(r.error||"Token invÃ¡lido ou expirado."))}catch(r){l(!1),f(r.message||"Erro ao validar token. Tente novamente.")}finally{y(!1)}};return g?Xe.jsx("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4",children:Xe.jsxs("div",{className:"text-center",children:[Xe.jsx("div",{className:"w-16 h-16 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),Xe.jsx("p",{className:"text-slate-600",children:"Validando token..."})]})}):Xe.jsx("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4 sm:p-6 font-sans",children:Xe.jsxs("div",{className:"w-full max-w-md",children:[Xe.jsxs("div",{className:"text-center mb-8 sm:mb-10",children:[Xe.jsx("div",{className:"inline-flex p-3 sm:p-4 bg-emerald-500 rounded-2xl shadow-lg mb-4 sm:mb-6",children:Xe.jsx(va,{size:28,className:"sm:w-9 sm:h-9 text-white"})}),Xe.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-slate-900 tracking-tight mb-2",children:"Definir Senha"}),Xe.jsx("p",{className:"text-xs sm:text-sm text-slate-500 font-medium",children:"Configure sua palavra-passe de acesso"})]}),Xe.jsxs("div",{className:"bg-white rounded-2xl sm:rounded-3xl p-6 sm:p-8 shadow-lg border border-slate-200",children:[!i&&Xe.jsxs("div",{className:"space-y-4",children:[Xe.jsx("div",{className:"mb-6 p-3 bg-rose-50 border border-rose-200 rounded-lg",children:Xe.jsxs("div",{className:"flex items-start gap-2",children:[Xe.jsx(Pa,{className:"text-rose-500 mt-0.5 flex-shrink-0",size:16}),Xe.jsx("p",{className:"text-rose-700 text-sm",children:x||"Link invÃ¡lido ou expirado."})]})}),Xe.jsx(_a,{onClick:()=>s("login"),className:"w-full",children:"Voltar para Login"})]}),b&&Xe.jsxs("div",{className:"space-y-4",children:[Xe.jsx("div",{className:"p-3 bg-emerald-50 border border-emerald-200 rounded-lg",children:Xe.jsx("p",{className:"text-emerald-700 text-sm",children:b})}),Xe.jsx(_a,{onClick:()=>s("login"),className:"w-full",children:"Ir para login"})]}),i&&!b&&Xe.jsxs("form",{className:"space-y-4 sm:space-y-6",onSubmit:async e=>{if(e.preventDefault(),f(null),v(null),u.trim())if(u.trim().length<6)f("A senha deve ter pelo menos 6 caracteres.");else if(u===h)if(a){c(!0);try{const e=await t(a,u,h);v(e.message||"Senha definida com sucesso!");const r=window.location.origin+window.location.pathname;window.history.replaceState({},document.title,r),setTimeout(()=>{s("login")},3e3)}catch(r){f(r.message||"Erro ao definir senha.")}finally{c(!1)}}else f("Token invÃ¡lido. Solicite um novo link.");else f("As senhas nÃ£o coincidem.");else f("Por favor, preencha a senha.")},children:[n&&Xe.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[Xe.jsxs("p",{className:"text-sm text-slate-600",children:["Bem-vindo, ",Xe.jsx("span",{className:"font-bold",children:n.name})]}),Xe.jsx("p",{className:"text-xs text-slate-500 mt-1",children:n.email})]}),x&&Xe.jsx("div",{className:"p-3 bg-rose-50 border border-rose-200 rounded-lg",children:Xe.jsx("p",{className:"text-rose-700 text-sm",children:x})}),Xe.jsxs("div",{className:"space-y-1.5",children:[Xe.jsxs("label",{className:"text-sm font-medium text-slate-700",children:["Nova senha ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsxs("div",{className:"relative",children:[Xe.jsx("input",{type:"password",value:u,onChange:e=>m(e.target.value),placeholder:"MÃ­nimo 6 caracteres",className:"w-full pl-10 pr-4 py-2.5 sm:py-3 bg-white border border-slate-300 focus:border-emerald-500 rounded-xl focus:ring-2 focus:ring-emerald-500/20 text-slate-900 outline-none transition-all text-sm",disabled:d,required:!0}),Xe.jsx(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18})]})]}),Xe.jsxs("div",{className:"space-y-1.5",children:[Xe.jsxs("label",{className:"text-sm font-medium text-slate-700",children:["Confirmar senha ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsxs("div",{className:"relative",children:[Xe.jsx("input",{type:"password",value:h,onChange:e=>p(e.target.value),placeholder:"Repita a senha",className:"w-full pl-10 pr-4 py-2.5 sm:py-3 bg-white border border-slate-300 focus:border-emerald-500 rounded-xl focus:ring-2 focus:ring-emerald-500/20 text-slate-900 outline-none transition-all text-sm",disabled:d,required:!0}),Xe.jsx(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18})]})]}),Xe.jsx(_a,{type:"submit",disabled:d,className:"w-full py-3 sm:py-3.5",children:d?"Definindo...":"Definir senha"})]})]})]})})},Ha=()=>{const{validateResetToken:e,resetPassword:t}=La(),{setView:s}=qa(),[a,r]=qe.useState(null),[i,l]=qe.useState(null),[n,o]=qe.useState(!1),[d,c]=qe.useState(""),[u,m]=qe.useState(""),[h,p]=qe.useState(""),[x,f]=qe.useState(null),[b,v]=qe.useState(null),[g,y]=qe.useState("verify-token");qe.useEffect(()=>{const e=new URLSearchParams(window.location.search).get("token");e?(r(e),k(e)):(l(!1),f("Link invÃ¡lido ou expirado. Solicite um novo link."))},[]);const k=async t=>{var s;try{o(!0);const a=await e(t);a.valid?(l(!0),c((null==(s=a.user)?void 0:s.email)||""),y("reset-form")):(l(!1),f(a.error||"Token invÃ¡lido ou expirado."))}catch(a){l(!1),f("Erro ao validar token. Tente novamente.")}finally{o(!1)}},w=()=>{s("login")};return n&&"verify-token"===g?Xe.jsx("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4",children:Xe.jsxs("div",{className:"text-center",children:[Xe.jsx("div",{className:"w-16 h-16 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),Xe.jsx("p",{className:"text-slate-600",children:"Validando token..."})]})}):"verify-token"===g?Xe.jsx("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4 sm:p-6 font-sans",children:Xe.jsxs("div",{className:"w-full max-w-md",children:[Xe.jsxs("div",{className:"text-center mb-8 sm:mb-10",children:[Xe.jsx("div",{className:"inline-flex p-3 sm:p-4 bg-emerald-500 rounded-2xl shadow-lg mb-4 sm:mb-6",children:Xe.jsx(va,{size:28,className:"sm:w-9 sm:h-9 text-white"})}),Xe.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-slate-900 tracking-tight mb-2",children:"Redefinir Senha"}),Xe.jsx("p",{className:"text-xs sm:text-sm text-slate-500 font-medium",children:"Verificando link de seguranÃ§a"})]}),Xe.jsx("div",{className:"bg-white rounded-2xl sm:rounded-3xl p-6 sm:p-8 shadow-lg border border-slate-200",children:!1===i&&Xe.jsxs(Xe.Fragment,{children:[Xe.jsx("div",{className:"mb-6 p-4 bg-rose-50 border border-rose-200 rounded-xl",children:Xe.jsxs("div",{className:"flex items-start gap-3",children:[Xe.jsx(Pa,{className:"text-rose-500 mt-0.5 flex-shrink-0",size:20}),Xe.jsxs("div",{children:[Xe.jsx("h3",{className:"font-bold text-rose-700 text-sm mb-1",children:"Link InvÃ¡lido"}),Xe.jsx("p",{className:"text-rose-600 text-xs",children:x})]})]})}),Xe.jsxs("div",{className:"space-y-4",children:[Xe.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[Xe.jsx("p",{className:"text-slate-600 text-sm mb-2",children:"PossÃ­veis causas:"}),Xe.jsxs("ul",{className:"text-slate-500 text-xs space-y-1",children:[Xe.jsxs("li",{className:"flex items-start gap-2",children:[Xe.jsx("span",{className:"text-rose-500 mt-0.5",children:"â¢"}),Xe.jsx("span",{children:"O link expirou (vÃ¡lido por 2 horas)"})]}),Xe.jsxs("li",{className:"flex items-start gap-2",children:[Xe.jsx("span",{className:"text-rose-500 mt-0.5",children:"â¢"}),Xe.jsx("span",{children:"O link jÃ¡ foi utilizado"})]}),Xe.jsxs("li",{className:"flex items-start gap-2",children:[Xe.jsx("span",{className:"text-rose-500 mt-0.5",children:"â¢"}),Xe.jsx("span",{children:"Link incorreto ou incompleto"})]})]})]}),Xe.jsx(_a,{onClick:w,className:"w-full",children:"Solicitar Novo Link"}),Xe.jsx("button",{onClick:()=>s("login"),className:"w-full py-2.5 text-slate-500 hover:text-slate-700 text-sm",children:"Voltar para Login"})]})]})})]})}):Xe.jsx("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4 sm:p-6 font-sans",children:Xe.jsxs("div",{className:"w-full max-w-md",children:[Xe.jsxs("div",{className:"text-center mb-8 sm:mb-10",children:[Xe.jsx("div",{className:"inline-flex p-3 sm:p-4 bg-emerald-500 rounded-2xl shadow-lg mb-4 sm:mb-6",children:Xe.jsx(va,{size:28,className:"sm:w-9 sm:h-9 text-white"})}),Xe.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-slate-900 tracking-tight mb-2",children:"Nova Senha"}),Xe.jsxs("p",{className:"text-xs sm:text-sm text-slate-500 font-medium",children:["Digite sua nova senha para ",d]})]}),Xe.jsx("div",{className:"bg-white rounded-2xl sm:rounded-3xl p-6 sm:p-8 shadow-lg border border-slate-200",children:b?Xe.jsxs("div",{className:"space-y-6",children:[Xe.jsx("div",{className:"p-4 bg-emerald-50 border border-emerald-200 rounded-xl",children:Xe.jsxs("div",{className:"flex items-start gap-3",children:[Xe.jsx(ha,{className:"text-emerald-500 mt-0.5 flex-shrink-0",size:20}),Xe.jsxs("div",{children:[Xe.jsx("h3",{className:"font-bold text-emerald-700 text-sm mb-1",children:"Senha Redefinida!"}),Xe.jsx("p",{className:"text-emerald-600 text-xs",children:b})]})]})}),Xe.jsxs("div",{className:"text-center",children:[Xe.jsx("div",{className:"w-16 h-16 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),Xe.jsx("p",{className:"text-slate-500 text-sm",children:"Redirecionando para login..."})]}),Xe.jsx(_a,{onClick:()=>s("login"),className:"w-full",children:"Ir para Login Agora"})]}):Xe.jsxs(Xe.Fragment,{children:[x&&Xe.jsx("div",{className:"mb-6 p-3 bg-rose-50 border border-rose-200 rounded-lg",children:Xe.jsxs("div",{className:"flex items-start gap-2",children:[Xe.jsx(Pa,{className:"text-rose-500 mt-0.5 flex-shrink-0",size:16}),Xe.jsx("p",{className:"text-rose-700 text-sm",children:x})]})}),Xe.jsxs("form",{className:"space-y-4 sm:space-y-6",onSubmit:async e=>{if(e.preventDefault(),f(null),v(null),u.trim())if(u.trim().length<6)f("A senha deve ter pelo menos 6 caracteres.");else if(u===h){o(!0);try{const e=await t(a,u,h);v(e.message||"Senha redefinida com sucesso!"),setTimeout(()=>{s("login")},3e3)}catch(r){f(r.message||"Erro ao redefinir senha.")}finally{o(!1)}}else f("As senhas nÃ£o coincidem.");else f("Por favor, preencha a nova senha.")},children:[Xe.jsxs("div",{className:"space-y-1.5",children:[Xe.jsxs("label",{className:"text-sm font-medium text-slate-700",children:["Nova senha ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsxs("div",{className:"relative",children:[Xe.jsx("input",{type:"password",value:u,onChange:e=>m(e.target.value),placeholder:"MÃ­nimo 6 caracteres",className:"w-full pl-10 pr-4 py-2.5 sm:py-3 bg-white border border-slate-300 focus:border-emerald-500 rounded-xl focus:ring-2 focus:ring-emerald-500/20 text-slate-900 outline-none transition-all text-sm",disabled:n,required:!0}),Xe.jsx(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18})]})]}),Xe.jsxs("div",{className:"space-y-1.5",children:[Xe.jsxs("label",{className:"text-sm font-medium text-slate-700",children:["Confirmar senha ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsxs("div",{className:"relative",children:[Xe.jsx("input",{type:"password",value:h,onChange:e=>p(e.target.value),placeholder:"Digite novamente a senha",className:"w-full pl-10 pr-4 py-2.5 sm:py-3 bg-white border border-slate-300 focus:border-emerald-500 rounded-xl focus:ring-2 focus:ring-emerald-500/20 text-slate-900 outline-none transition-all text-sm",disabled:n,required:!0}),Xe.jsx(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18})]})]}),Xe.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[Xe.jsx("p",{className:"text-slate-600 text-xs font-medium mb-2",children:"Requisitos da senha:"}),Xe.jsxs("ul",{className:"text-slate-500 text-xs space-y-1",children:[Xe.jsxs("li",{className:"flex items-center gap-2 "+(u.length>=6?"text-emerald-600":""),children:[Xe.jsx(ca,{size:12,className:u.length>=6?"text-emerald-500":"text-slate-300"}),Xe.jsx("span",{children:"MÃ­nimo 6 caracteres"})]}),Xe.jsxs("li",{className:"flex items-center gap-2 "+(u===h&&u?"text-emerald-600":""),children:[Xe.jsx(ca,{size:12,className:u===h&&u?"text-emerald-500":"text-slate-300"}),Xe.jsx("span",{children:"As senhas coincidem"})]})]})]}),Xe.jsx(_a,{type:"submit",disabled:n,className:"w-full py-3 sm:py-3.5",children:n?Xe.jsxs(Xe.Fragment,{children:[Xe.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Redefinindo senha..."]}):"Redefinir Senha"}),Xe.jsx("button",{type:"button",onClick:()=>s("login"),disabled:n,className:"w-full py-2.5 text-slate-500 hover:text-slate-700 text-sm disabled:text-slate-400 transition-colors",children:"Voltar para Login"})]})]})})]})})},Ka={pt:{brandName:"GESTORA",dashboard:"Painel Principal",opportunities:"Oportunidades",contracts:"Contratos",clients:"Clientes",articles:"Artigos",events:"Actividades",tasks:"GestÃ£o de Tarefas",invoicing:"FaturaÃ§Ã£o",nonConformities:"Conformidades",users:"GestÃ£o de UsuÃ¡rios",profile:"Perfil",logout:"Sair",createTask:"Nova Tarefa",editTask:"Editar",deleteTask:"Excluir",search:"Procurar por tÃ­tulo...",filterByStatus:"Filtrar por Estado",allStatuses:"Todos os Estados",noTasks:"Nenhum registro encontrado.",responsible:"ResponsÃ¡vel Principal",intervenientes:"Intervenientes",startDate:"Data de InÃ­cio",deadline:"Prazo",deliveryDate:"Entrega Prevista",days:"Dias",hours:"Horas",description:"DescriÃ§Ã£o Detalhada",title:"TÃ­tulo da Tarefa",status:"Estado Atual",updateStatus:"AvanÃ§ar Status",closeTask:"Validar e Fechar",latestUpdates:"Actividade Recente",notifications:"NotificaÃ§Ãµes",overdue:"Atrasada",extendDeadline:"Prorrogar Prazo",save:"Salvar",cancel:"Cancelar",login:"Acesso ao Sistema",email:"EndereÃ§o de E-mail",password:"Palavra-passe",landingTitle:"A gestÃ£o de atividades da sua equipe levada ao prÃ³ximo nÃ­vel de excelÃªncia",landingDesc:"Simplifique processos, monitore prazos com precisÃ£o cirÃºrgica e impulsione a performance do seu time com a ferramenta de gestÃ£o mais intuitiva do mercado.",accessSystem:"Entrar no Sistema",back:"Voltar",welcome:"OlÃ¡,",activeTasks:"Ativas",overdueTasks:"Em Atraso",completedTasks:"ConcluÃ­das",addUser:"Adicionar UsuÃ¡rio",manageUsers:"GestÃ£o de Equipe",settings:"ConfiguraÃ§Ãµes",theme:"Tema",language:"Idioma",startNow:"Comece Agora",startFree:"Teste Gratuitamente",learnMore:"Saiba Mais",name:"Nome",position:"Cargo",department:"Departamento",editUser:"Editar UsuÃ¡rio",deleteUser:"Deletar UsuÃ¡rio",activateUser:"Ativar UsuÃ¡rio",deactivateUser:"Desativar UsuÃ¡rio",userProfile:"Perfil do UsuÃ¡rio",editProfile:"Editar Perfil",changeAvatar:"Alterar Foto",myProfile:"Meu Perfil",darkMode:"Modo Escuro",lightMode:"Modo Claro",portuguese:"PortuguÃªs",english:"InglÃªs",reports:"RelatÃ³rios Gerenciais",taskMetrics:"MÃ©tricas de Tarefas",userPerformance:"Desempenho da Equipe",productivityReport:"RelatÃ³rio de Produtividade",totalTasks:"Total de Tarefas",activeCount:"Tarefas Ativas",completedCount:"Tarefas ConcluÃ­das",overdueCount:"Tarefas Atrasadas",completionRate:"Taxa de ConclusÃ£o",averageDelay:"Atraso MÃ©dio",taskDistribution:"DistribuiÃ§Ã£o de Tarefas",validateTask:"Validar Tarefa",reopenTask:"Reabrir Tarefa",taskDetails:"Detalhes da Tarefa",extendDate:"Estender Prazo",extendDays:"Dias para Estender",sendForValidation:"Enviar para ValidaÃ§Ã£o",validationFeedback:"Feedback de ValidaÃ§Ã£o",validatedBy:"Validado por",validatedAt:"Validado em",recentActivity:"Actividade Recente",taskCreated:"Tarefa criada com sucesso",taskUpdated:"Tarefa atualizada",taskDeleted:"Tarefa deletada",statusChanged:"Status alterado para",taskValidated:"Tarefa validada",deadlineApproaching:"Prazo se aproximando",taskOverdue:"Tarefa atrasada",delayCausesMoreDelay:"Seu atraso nos atrasa",taskCompleted:"VocÃª finalizou a tarefa com sucesso",hasTaskToStart:"VocÃª tem uma tarefa por fazer",noNotifications:"Tudo em dia",viewMore:"Ver mais",markAsRead:"Marcar como lido",clearAll:"Limpar tudo",noUsers:"Nenhum usuÃ¡rio encontrado",selectUser:"Selecione um usuÃ¡rio",areYouSure:"Tem certeza?",userAdded:"UsuÃ¡rio adicionado com sucesso",userUpdated:"UsuÃ¡rio atualizado",userDeleted:"UsuÃ¡rio deletado",close:"Fechar",edit:"Editar",delete:"Deletar",confirm:"Confirmar",loading:"Carregando...",errorOccurred:"Erro ao processar requisiÃ§Ã£o",success:"Sucesso",warning:"Aviso",error:"Erro",info:"InformaÃ§Ã£o",responsibles:"ResponsÃ¡veis",roadmap:"Roadmap",enterprise:"Enterprise",features:"Funcionalidades"},en:{brandName:"GESTORA",dashboard:"Dashboard",opportunities:"Opportunities",contracts:"Contracts",clients:"Clients",articles:"Articles",events:"Activities",tasks:"Task Management",invoicing:"Invoicing",nonConformities:"Conformities",users:"Users",profile:"Profile",logout:"Logout",createTask:"New Task",editTask:"Edit",deleteTask:"Delete",search:"Search by title...",filterByStatus:"Filter Status",allStatuses:"All Statuses",noTasks:"No tasks found.",responsible:"Main Responsible",intervenientes:"Stakeholders",startDate:"Start Date",deadline:"Deadline",deliveryDate:"Estimated Delivery",days:"Days",hours:"Hours",description:"Detailed Description",title:"Task Title",status:"Current Status",updateStatus:"Advance Status",closeTask:"Validate & Close",latestUpdates:"Recent Activity",notifications:"Notifications",overdue:"Overdue",extendDeadline:"Extend Deadline",save:"Save",cancel:"Cancel",login:"System Login",email:"Email Address",password:"Password",landingTitle:"Your team activity management taken to the next level of excellence",landingDesc:"Simplify processes, monitor deadlines with surgical precision and boost your team performance with the most intuitive management tool on the market.",accessSystem:"Sign In",back:"Back",welcome:"Hello,",activeTasks:"Active",overdueTasks:"Overdue",completedTasks:"Completed",addUser:"Add User",manageUsers:"Team Management",settings:"Settings",theme:"Theme",language:"Language",startNow:"Start Now",startFree:"Start Free",learnMore:"Learn More",name:"Name",position:"Position",department:"Department",editUser:"Edit User",deleteUser:"Delete User",activateUser:"Activate User",deactivateUser:"Deactivate User",userProfile:"User Profile",editProfile:"Edit Profile",changeAvatar:"Change Avatar",myProfile:"My Profile",darkMode:"Dark Mode",lightMode:"Light Mode",portuguese:"Portuguese",english:"English",reports:"Management Reports",taskMetrics:"Task Metrics",userPerformance:"Team Performance",productivityReport:"Productivity Report",totalTasks:"Total Tasks",activeCount:"Active Tasks",completedCount:"Completed Tasks",overdueCount:"Overdue Tasks",completionRate:"Completion Rate",averageDelay:"Average Delay",taskDistribution:"Task Distribution",validateTask:"Validate Task",reopenTask:"Reopen Task",taskDetails:"Task Details",extendDate:"Extend Deadline",extendDays:"Days to Extend",sendForValidation:"Send for Validation",validationFeedback:"Validation Feedback",validatedBy:"Validated By",validatedAt:"Validated At",recentActivity:"Recent Activity",taskCreated:"Task created successfully",taskUpdated:"Task updated",taskDeleted:"Task deleted",statusChanged:"Status changed to",taskValidated:"Task validated",deadlineApproaching:"Deadline approaching",taskOverdue:"Task is overdue",delayCausesMoreDelay:"Your delay delays us",taskCompleted:"You completed the task successfully",hasTaskToStart:"You have a task to start",noNotifications:"All caught up",viewMore:"View More",markAsRead:"Mark as Read",clearAll:"Clear All",noUsers:"No users found",selectUser:"Select a user",areYouSure:"Are you sure?",userAdded:"User added successfully",userUpdated:"User updated",userDeleted:"User deleted",close:"Close",edit:"Edit",delete:"Delete",confirm:"Confirm",loading:"Loading...",errorOccurred:"Error processing request",success:"Success",warning:"Warning",error:"Error",info:"Information",responsibles:"Assignees",roadmap:"Roadmap",enterprise:"Enterprise",features:"Features"}};
/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */us.ADMIN,us.EMPLOYEE,us.EMPLOYEE,us.EMPLOYEE,ms.ABERTO,(new Date).toISOString(),(new Date).toISOString(),ms.POR_INICIAR,(new Date).toISOString(),(new Date).toISOString(),ms.EM_PROGRESSO,(new Date).toISOString(),(new Date).toISOString(),ms.TERMINADO,(new Date).toISOString(),(new Date).toISOString(),ms.FECHADO,(new Date).toISOString(),(new Date).toISOString(),(new Date).toISOString(),ms.ATRASADA,(new Date).toISOString(),(new Date).toISOString(),ms.ABERTO,ms.POR_INICIAR,ms.EM_PROGRESSO,ms.TERMINADO,ms.FECHADO,ms.ATRASADA;const Ya=()=>{const e=qe.useContext(Ys);if(!e)throw new Error("useLanguage must be used within AppProvider");const t=Ka[e.lang];return{lang:e.lang,setLang:e.setLang,t:t}},Ba=()=>{const{setView:e}=qa(),{lang:t}=Ya(),s=Ka[t];return Xe.jsxs("div",{className:"landing-multi-font min-h-screen bg-white flex flex-col",children:[Xe.jsx("nav",{className:"fixed top-0 left-0 right-0 bg-white/80 backdrop-blur-xl z-[100] border-b border-slate-200/60 h-16 sm:h-[72px]",children:Xe.jsxs("div",{className:"max-w-6xl mx-auto px-5 sm:px-8 h-full flex items-center justify-between",children:[Xe.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>e("landing"),children:[Xe.jsx("div",{className:"w-9 h-9 rounded-lg bg-slate-900 flex items-center justify-center",children:Xe.jsx(za,{className:"text-white",size:18})}),Xe.jsx("span",{className:"text-[15px] sm:text-base font-semibold text-slate-900 tracking-tight",children:"GESTORA"})]}),Xe.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[Xe.jsx("button",{onClick:()=>e("landing"),className:"text-[13px] sm:text-sm font-medium text-slate-600 hover:text-slate-900 px-3 py-2 rounded-lg hover:bg-slate-100/80 transition-colors",children:"InÃ­cio"}),Xe.jsx("button",{onClick:()=>e("login"),className:"text-[13px] sm:text-sm font-medium text-white bg-slate-900 hover:bg-slate-800 px-4 sm:px-5 py-2 sm:py-2.5 rounded-lg transition-colors shadow-sm",children:"Entrar"})]})]})}),Xe.jsxs("section",{className:"pt-32 sm:pt-40 md:pt-48 lg:pt-64 pb-32 sm:pb-40 md:pb-56 px-4 sm:px-6 lg:px-8 text-center max-w-6xl mx-auto space-y-8 sm:space-y-12",children:[Xe.jsxs("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-black text-slate-800 leading-[1.05] tracking-tight animate-in",children:[s.landingTitle.split(" simples e eficaz")[0]," ",Xe.jsx("span",{className:"text-[#10b981]",children:"simples"})," e ",Xe.jsx("span",{className:"text-[#10b981]",children:"eficaz"})]}),Xe.jsx("p",{className:"text-base sm:text-lg lg:text-[20px] text-slate-500 max-w-3xl mx-auto font-medium animate-in leading-relaxed px-2",children:s.landingDesc}),Xe.jsx("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-5 justify-center items-center pt-6 sm:pt-8 animate-in",children:Xe.jsxs("button",{onClick:()=>e("login"),className:"flex items-center justify-center gap-2 px-10 sm:px-14 py-4 sm:py-5 rounded-full border-2 border-[#10b981] text-[#10b981] font-bold hover:bg-[#10b981] hover:text-white transition-all text-base group w-full sm:w-auto",children:["ComeÃ§ar Agora ",Xe.jsx(ia,{size:20,className:"group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"})]})})]}),Xe.jsx("footer",{className:"bg-slate-950 text-white py-14 px-8",children:Xe.jsxs("div",{className:"max-w-6xl mx-auto flex flex-col items-center gap-5",children:[Xe.jsxs("div",{className:"flex items-center gap-2.5 text-slate-400",children:[Xe.jsx(za,{size:18}),Xe.jsx("span",{className:"text-sm font-semibold tracking-tight",children:"GESTORA"})]}),Xe.jsx("p",{className:"text-slate-500 text-xs tracking-wide",children:"Â© 2026 ILUNGI GESTORA"})]})})]})},Ja=()=>{const e=qe.useContext(Ys);if(!e)throw new Error("useTasks must be used within AppProvider");return{tasks:e.tasks,setTasks:e.setTasks,filteredTasks:e.filteredTasks,filterTasks:e.filterTasks,createTask:e.createTask,updateTask:e.updateTask,deleteTask:e.deleteTask,handleAdvanceStatus:e.handleAdvanceStatus,handleRegressStatus:e.handleRegressStatus,handleDeleteTask:e.handleDeleteTask,addComment:e.addComment}},Xa="users",Za=e=>Array.isArray(e)?e.map(qs):(null==e?void 0:e.content)&&Array.isArray(e.content)?e.content.map(qs):[],er=async()=>{try{const e=await Ds();return Za(e)}catch(e){const t=await Us();return Za(t)}},tr=async e=>{const t=await Ms({name:e.name,email:e.email,phone:e.phone,role:e.role||xs.EMPLOYEE});return qs(t)},sr=async({id:e,...t})=>{const s=await Ps(e,{name:t.name,phone:t.phone,role:t.role});return qs(s)},ar=async e=>{await Rs(e)},rr=async({id:e,role:t})=>{const s=await Is(e,t);return qs(s)},ir=()=>{const e=ss(),t=qe.useContext(Ys);if(!t)throw new Error("useUsers must be used within AppProvider");const{data:s=[],isLoading:a,error:r,refetch:i}=os({queryKey:[Xa],queryFn:er,staleTime:3e5,gcTime:6e5,refetchOnWindowFocus:!0,refetchOnMount:!0,refetchOnReconnect:!0,retry:3}),l=ds({mutationFn:tr,onSuccess:t=>{e.setQueryData([Xa],(e=[])=>e.some(e=>e.id===t.id)?e:[...e,t])},onError:t=>{e.invalidateQueries({queryKey:[Xa]})}}),n=ds({mutationFn:sr,onSuccess:t=>{e.setQueryData([Xa],(e=[])=>e.map(e=>e.id===t.id?t:e))},onError:(t,s)=>{e.invalidateQueries({queryKey:[Xa]})}}),o=ds({mutationFn:ar,onSuccess:(t,s)=>{e.setQueryData([Xa],(e=[])=>e.filter(e=>e.id!==s))},onError:t=>{e.invalidateQueries({queryKey:[Xa]})}}),d=ds({mutationFn:rr,onSuccess:t=>{e.setQueryData([Xa],(e=[])=>e.map(e=>e.id===t.id?t:e))}});return{users:s,isLoading:a,error:r,refetch:i,createUser:l.mutateAsync,updateUser:n.mutateAsync,deleteUser:o.mutateAsync,updateUserRole:d.mutateAsync,isCreating:l.isPending,isUpdating:n.isPending,isDeleting:o.isPending,isUpdatingRole:d.isPending,createError:l.error,updateError:n.error,deleteError:o.error,roleError:d.error,user:t.user,setUser:t.setUser,getAvatarUrl:t.getAvatarUrl,saveAvatar:t.saveAvatar,openAvatarUpload:t.openAvatarUpload,loadUsers:t.loadUsers}},lr=({icon:e,label:t,active:s,collapsed:a,onClick:r})=>Xe.jsxs("button",{onClick:r,className:"w-full flex items-center gap-5 px-6 py-4 rounded-2xl transition-all group relative \n        "+(s?"bg-[#10b981] text-white shadow-xl shadow-emerald-500/20":"text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800/50 hover:text-slate-900 dark:hover:text-white"),children:[Xe.jsx("div",{className:"transition-transform duration-300 "+(s?"scale-110":"group-hover:scale-110"),children:e}),!a&&Xe.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest animate-in font-bold",children:t})]}),nr=[ms.PENDENTE,ms.EM_PROGRESSO,ms.TERMINADO,ms.FECHADO],or={[ms.PENDENTE]:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400",[ms.EM_PROGRESSO]:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",[ms.TERMINADO]:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400",[ms.FECHADO]:"bg-slate-100 text-slate-700 dark:bg-slate-900/30 dark:text-slate-400",[ms.ATRASADA]:"bg-rose-100 text-rose-700 dark:bg-rose-900/30 dark:text-rose-400"},dr=({task:e,user:t,users:s,onAdvance:a,onRegress:r,onDelete:i,onEdit:l,onAddComment:n})=>{var o,d,c,u,m;const[h,p]=qe.useState(""),[x,f]=qe.useState(!1),[b,v]=qe.useState(!1),g=(e=>{if(Object.values(ms).includes(e))return e;return{ABERTO:ms.PENDENTE,ABERTA:ms.PENDENTE,EM_ANDAMENTO:ms.EM_PROGRESSO,"EM ANDAMENTO":ms.EM_PROGRESSO,EM_EXECUCAO:ms.EM_PROGRESSO,"EM EXECUCAO":ms.EM_PROGRESSO,EM_REVISAO:ms.EM_PROGRESSO,"EM REVISAO":ms.EM_PROGRESSO,REVISAO:ms.EM_PROGRESSO,CONCLUIDA:ms.TERMINADO,"CONCLUÃDA":ms.TERMINADO,CONCLUIDO:ms.TERMINADO,"CONCLUÃDO":ms.TERMINADO,ARQUIVADO:ms.FECHADO,ARQUIVADA:ms.FECHADO,CANCELADA:ms.FECHADO}[e]||e})(e.status);if(!Array.isArray(nr)||0===nr.length)return Xe.jsx("div",{children:"Erro: StatusOrder nÃ£o configurado"});const y=nr.indexOf(g),k=-1!==y,w=g===ms.ATRASADA,j=g===ms.TERMINADO,N=g===ms.FECHADO||w;let A=null,S=null;k&&(y<nr.length-1&&(A=nr[y+1]),y>0&&(S=nr[y-1]));const E=e.responsibleId===t.id||(null==(o=e.intervenientes)?void 0:o.includes(t.id)),T=t.role===us.ADMIN,C=!N&&null!==A&&(T||E),O=!N&&null!==S&&(T||E),D=j?T&&C:C,M=j?T&&O:O,P=null==(d=null==s?void 0:s.find(t=>t.id===e.responsibleId))?void 0:d.name,R=(null==(c=e.intervenientes)?void 0:c.length)?` +${e.intervenientes.length}`:"";return Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl sm:rounded-[3.5rem] p-6 sm:p-10 border border-slate-100 dark:border-slate-800 shadow-sm hover:shadow-2xl transition-all group flex flex-col h-full relative overflow-hidden",children:[g===ms.ATRASADA&&Xe.jsx("div",{className:"absolute top-0 right-0 w-24 sm:w-32 h-24 sm:h-32 bg-rose-500/10 rounded-full -mr-12 sm:-mr-16 -mt-12 sm:-mt-16 flex items-end justify-start p-4 sm:p-8",children:Xe.jsx(Pa,{className:"text-rose-500",size:20})}),Xe.jsxs("div",{className:"flex justify-between items-start mb-4 sm:mb-8",children:[Xe.jsx("span",{className:`px-3 sm:px-5 py-1.5 sm:py-2 rounded-full text-[8px] sm:text-[9px] font-black uppercase tracking-widest ${or[g]||or[ms.PENDENTE]}`,children:g===ms.EM_PROGRESSO?"EM PROGRESSO":g}),T&&Xe.jsxs("div",{className:"flex gap-1",children:[l&&Xe.jsx("button",{onClick:l,className:"p-2 text-slate-300 hover:text-[#10b981] transition-colors",title:"Editar",children:Xe.jsx(ja,{size:16})}),Xe.jsx("button",{onClick:i,className:"p-2 text-slate-300 hover:text-rose-500 transition-colors",title:"Eliminar",children:Xe.jsx(Ma,{size:16})})]})]}),Xe.jsxs("div",{className:"flex-1 space-y-3 sm:space-y-4",children:[Xe.jsx("h3",{className:"text-lg sm:text-2xl font-black tracking-tight leading-tight group-hover:text-[#10b981] transition-colors",children:e.title}),Xe.jsx("p",{className:"text-xs sm:text-sm text-slate-400 font-medium leading-relaxed line-clamp-3",children:e.description}),P&&Xe.jsxs("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:["ResponsÃ¡vel: ",P,R]}),(E||T)&&Xe.jsxs("div",{className:"pt-3 border-t border-slate-100 dark:border-slate-800",children:[Xe.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Xe.jsxs("p",{className:"text-xs font-bold text-slate-500",children:["ð¬ ComentÃ¡rios (",(null==(u=e.comments)?void 0:u.length)||0,")"]}),T&&(null==(m=e.comments)?void 0:m.length)>0&&Xe.jsx("button",{onClick:()=>f(!x),className:"text-[9px] font-bold text-[#10b981] hover:text-[#059669] transition-colors",children:x?"Ocultar tudo":"Ver tudo"})]}),(x||!T)&&Xe.jsx("div",{className:"space-y-2 mb-3 max-h-32 overflow-y-auto",children:(e.comments||[]).map(e=>Xe.jsxs("div",{className:"text-sm text-slate-600 bg-slate-50 dark:bg-slate-800 p-2 rounded-md",children:[Xe.jsxs("span",{className:"font-bold text-slate-800 dark:text-white mr-2",children:[e.userName,":"]}),Xe.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:e.text}),Xe.jsx("div",{className:"text-[9px] text-slate-400 mt-1",children:new Date(e.timestamp).toLocaleString("pt-PT")})]},e.id))}),E&&n&&Xe.jsxs("div",{className:"flex gap-2",children:[Xe.jsx("input",{value:h,onChange:e=>p(e.target.value),onKeyPress:e=>{"Enter"===e.key&&h.trim()&&(n(h.trim()),p(""))},placeholder:"Adicionar comentÃ¡rio...",className:"flex-1 px-3 py-1.5 rounded-lg bg-slate-50 dark:bg-slate-800 outline-none text-xs"}),Xe.jsx("button",{onClick:()=>{h.trim()&&(n(h.trim()),p(""))},className:"px-3 py-1.5 rounded-lg bg-[#10b981] text-white font-bold text-xs hover:bg-[#059669] transition-colors",children:"+"})]})]})]}),Xe.jsxs("div",{className:"mt-6 sm:mt-10 pt-6 sm:pt-8 border-t border-slate-50 dark:border-slate-800",children:[Xe.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-4",children:[Xe.jsx(oa,{size:14}),Xe.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest",children:["Prazo: ",new Date(e.deliveryDate).toLocaleDateString("pt-PT",{day:"2-digit",month:"2-digit",year:"numeric"})]})]}),g!==ms.ATRASADA?N?Xe.jsxs("div",{className:"text-[#10b981] flex items-center gap-1 font-black text-[9px] uppercase tracking-widest",children:[Xe.jsx(ha,{size:16})," Fechada"]}):Xe.jsxs("div",{className:"flex gap-2",children:[M&&r&&Xe.jsxs("button",{disabled:b,onClick:async()=>{if(M&&r){v(!0);try{await r()}catch(e){}finally{v(!1)}}},className:"flex-1 py-2.5 sm:py-3 rounded-xl sm:rounded-2xl text-[9px] font-black uppercase tracking-widest shadow-xl transition-all flex items-center justify-center gap-2 bg-slate-700 hover:bg-slate-600 text-white",children:[b?Xe.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):Xe.jsx(aa,{size:14}),"Recuar"]}),D&&Xe.jsxs("button",{disabled:b,onClick:async()=>{if(D){v(!0);try{await a()}catch(e){}finally{v(!1)}}},className:"flex-1 py-2.5 sm:py-3 rounded-xl sm:rounded-2xl text-[9px] font-black uppercase tracking-widest shadow-xl transition-all flex items-center justify-center gap-2\n                    "+(j?"bg-[#10b981] text-white shadow-emerald-500/20":"bg-slate-900 dark:bg-slate-700 text-white hover:bg-[#10b981]"),children:[b?Xe.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):j?T?Xe.jsx(ca,{size:14}):Xe.jsx(Ea,{size:14}):Xe.jsx(ra,{size:14}),j?T?"Validar":"Finalizada":g===ms.PENDENTE?"Iniciar":g===ms.EM_PROGRESSO?"Concluir":g===ms.TERMINADO?"Fechar":"AvanÃ§ar"]}),E&&!D&&!M&&!N&&Xe.jsx("div",{className:"w-full text-center text-[10px] text-slate-400 py-2",children:A||S?"NÃ£o Ã© possÃ­vel alterar":"Sem mais aÃ§Ãµes disponÃ­veis"}),!E&&!T&&!N&&Xe.jsx("div",{className:"w-full text-center text-[10px] text-slate-400 py-2",children:"Apenas membros da tarefa podem agir"})]}):Xe.jsxs("div",{className:"text-rose-500 flex items-center gap-1 font-black text-[9px] uppercase tracking-widest",children:[Xe.jsx(Pa,{size:16})," Em atraso"]})]})]})},cr=({isOpen:e,editingTaskId:t,onClose:s})=>{var a;const{tasks:r,createTask:i,updateTask:l}=Ja(),{users:n}=ir(),[o,d]=qe.useState(!1),[c,u]=qe.useState(null),[m,h]=qe.useState(""),p=t?r.find(e=>e.id===t):null,x=p?[p.responsibleId,...p.intervenientes||[]]:[],f=n&&Array.isArray(n)&&n.length>0;qe.useEffect(()=>{h(p?new Date(p.deliveryDate).toLocaleString("pt-PT",{dateStyle:"short",timeStyle:"short"}):"")},[p]);const b=e=>{var t,s,a;const r=null==(t=null==e?void 0:e.elements.namedItem("startDate"))?void 0:t.value,i=null==(s=null==e?void 0:e.elements.namedItem("deadlineValue"))?void 0:s.value,l=null==(a=null==e?void 0:e.elements.namedItem("deadlineType"))?void 0:a.value;if(r&&i&&l){const e=new Date(r);"days"===l?e.setDate(e.getDate()+Number(i)):e.setHours(e.getHours()+Number(i)),h(e.toLocaleString("pt-PT",{dateStyle:"short",timeStyle:"short"}))}else h("")};return e||t?Xe.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[100] flex items-center justify-center p-4 sm:p-6 overflow-y-auto py-8 animate-in",children:Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-3xl max-h-[90vh] overflow-y-auto rounded-2xl p-5 sm:p-6 border border-slate-100 dark:border-slate-800 shadow-2xl relative my-auto",children:[Xe.jsx("button",{onClick:s,className:"absolute top-3 right-3 sm:top-4 sm:right-4 p-2 text-slate-300 hover:text-rose-500 transition-colors z-10",disabled:o,children:Xe.jsx(Fa,{size:18,className:"sm:w-5 sm:h-5"})}),Xe.jsx("h2",{className:"text-lg sm:text-xl font-black tracking-tighter mb-4 uppercase text-slate-800 dark:text-white",children:p?"Editar Tarefa":"Nova Actividade"}),c&&Xe.jsx("div",{className:"mb-4 p-3 bg-rose-50 border border-rose-200 rounded-lg",children:Xe.jsxs("div",{className:"flex items-start gap-2",children:[Xe.jsx(Pa,{className:"text-rose-500 mt-0.5 flex-shrink-0",size:16}),Xe.jsx("p",{className:"text-rose-700 text-sm",children:c})]})}),Xe.jsxs("form",{id:"taskForm",className:"grid grid-cols-1 md:grid-cols-2 gap-2 sm:gap-3",onSubmit:async e=>{var t,a,r;e.preventDefault();const n=new FormData(e.target),o=n.getAll("responsibleIds");if(!o||0===o.length)return void u("Selecione pelo menos um responsÃ¡vel.");u(null),d(!0);const c=n.get("startDate"),m=Number(n.get("deadlineValue")),x=n.get("deadlineType")||"days",f="days"===x?m:Math.ceil(m/24);try{p?await l(p.id,{title:n.get("title"),description:n.get("description"),startDate:c,deadlineValue:m,deadlineType:x,responsibleId:o[0],intervenientes:o.slice(1)}):await i({title:n.get("title"),description:n.get("description"),daysToFinish:f,responsibles:o.map(e=>Number(e))}),s(),h("")}catch(b){let e="NÃ£o foi possÃ­vel criar/atualizar na API.";(null==(t=b.message)?void 0:t.includes("400"))?e="Formato de dados invÃ¡lido. Verifique os responsÃ¡veis.":(null==(a=b.message)?void 0:a.includes("401"))?e="Acesso nÃ£o autorizado. FaÃ§a login novamente.":(null==(r=b.message)?void 0:r.includes("403"))&&(e="Sem permissÃ£o para realizar esta aÃ§Ã£o."),u(e)}finally{d(!1)}},children:[Xe.jsxs("div",{className:"md:col-span-2 space-y-1",children:[Xe.jsxs("label",{className:"text-[8px] font-black uppercase text-slate-400 tracking-widest ml-1",children:["TÃ­tulo ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsx("input",{name:"title",defaultValue:null==p?void 0:p.title,className:"w-full px-3 py-2.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-emerald-500/30 focus:border-emerald-500 font-bold text-sm",required:!0,placeholder:"Digite o tÃ­tulo da tarefa",disabled:o})]}),Xe.jsxs("div",{className:"md:col-span-2 space-y-1",children:[Xe.jsxs("label",{className:"text-[8px] font-black uppercase text-slate-400 tracking-widest ml-1",children:["DescriÃ§Ã£o ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsx("textarea",{name:"description",defaultValue:null==p?void 0:p.description,rows:3,className:"w-full px-3 py-2.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-emerald-500/30 focus:border-emerald-500 font-medium resize-none text-sm",required:!0,placeholder:"Descreva a tarefa em detalhes",disabled:o})]}),Xe.jsxs("div",{className:"space-y-1",children:[Xe.jsxs("label",{className:"text-[8px] font-black uppercase text-slate-400 tracking-widest ml-1",children:["Data InÃ­cio ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsx("input",{name:"startDate",type:"datetime-local",defaultValue:null==(a=null==p?void 0:p.startDate)?void 0:a.slice(0,16),onInput:e=>b(e.target.form),className:"w-full px-3 py-2.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-emerald-500/30 focus:border-emerald-500 font-bold text-sm",required:!0,disabled:o})]}),Xe.jsxs("div",{className:"space-y-1",children:[Xe.jsxs("label",{className:"text-[8px] font-black uppercase text-slate-400 tracking-widest ml-1",children:["DuraÃ§Ã£o ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsxs("div",{className:"flex gap-2",children:[Xe.jsx("input",{name:"deadlineValue",type:"number",defaultValue:(null==p?void 0:p.deadlineValue)??1,min:1,onInput:e=>b(e.target.form),className:"flex-1 px-3 py-2.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-emerald-500/30 focus:border-emerald-500 font-bold text-sm",required:!0,disabled:o}),Xe.jsxs("select",{name:"deadlineType",defaultValue:(null==p?void 0:p.deadlineType)||"days",onChange:e=>b(e.target.form),className:"px-3 py-2.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg outline-none focus:ring-2 focus:ring-emerald-500/30 focus:border-emerald-500 font-bold text-sm",disabled:o,children:[Xe.jsx("option",{value:"days",children:"Dias"}),Xe.jsx("option",{value:"hours",children:"Horas"})]})]})]}),Xe.jsxs("div",{className:"md:col-span-2 space-y-1",children:[Xe.jsx("label",{className:"text-[8px] font-black uppercase text-slate-400 tracking-widest ml-1",children:"Data Entrega (calculada)"}),Xe.jsx("div",{className:"px-3 py-2.5 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded-lg font-bold text-emerald-600 dark:text-emerald-400 text-sm",children:m||(p?new Date(p.deliveryDate).toLocaleString("pt-PT",{dateStyle:"short",timeStyle:"short"}):"â")})]}),Xe.jsxs("div",{className:"md:col-span-2 space-y-1",children:[Xe.jsxs("label",{className:"text-[8px] font-black uppercase text-slate-400 tracking-widest ml-1",children:["ResponsÃ¡veis (mÃºltipla escolha) ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),f?Xe.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 p-3 bg-slate-50 dark:bg-slate-800 rounded-lg max-h-48 overflow-y-auto",children:n.map(e=>Xe.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 transition-colors "+(o?"opacity-50 cursor-not-allowed":"cursor-pointer hover:bg-emerald-50 dark:hover:bg-emerald-900/20"),children:[Xe.jsx("input",{type:"checkbox",name:"responsibleIds",value:e.id,defaultChecked:x.includes(e.id),className:"w-4 h-4 text-emerald-600 rounded border-slate-300 focus:ring-emerald-500/20",disabled:o}),Xe.jsxs("div",{className:"flex-1 min-w-0",children:[Xe.jsx("p",{className:"font-bold text-slate-900 dark:text-white text-xs truncate",children:e.name}),Xe.jsx("p",{className:"text-[9px] text-slate-500 dark:text-slate-400 truncate",children:e.email})]}),"ADMIN"===e.role&&Xe.jsx("span",{className:"text-[8px] font-bold text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 px-1.5 py-0.5 rounded-full",children:"Admin"})]},e.id))}):Xe.jsxs("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg text-center",children:[Xe.jsx("p",{className:"text-amber-700 dark:text-amber-400 text-sm font-bold",children:"â ï¸ Nenhum utilizador encontrado"}),Xe.jsx("p",{className:"text-amber-600 dark:text-amber-500 text-xs mt-1",children:"Ã necessÃ¡rio ter pelo menos um utilizador cadastrado para criar tarefas."})]}),f&&Xe.jsxs("p",{className:"text-[9px] text-slate-400 mt-1",children:["Selecionados: ",x.length," utilizador(es)"]})]}),Xe.jsx("div",{className:"md:col-span-2 pt-4 mt-2 border-t border-slate-100 dark:border-slate-800",children:Xe.jsxs("div",{className:"flex gap-3",children:[Xe.jsx(_a,{type:"submit",disabled:!f||o,className:"flex-1 py-3 rounded-xl bg-[#10b981] hover:bg-[#059669] shadow-lg shadow-emerald-500/20 text-sm uppercase tracking-wider",children:o?Xe.jsxs(Xe.Fragment,{children:[Xe.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),p?"A guardar...":"A criar..."]}):p?"Guardar AlteraÃ§Ãµes":"Criar Tarefa"}),Xe.jsx(_a,{type:"button",variant:"ghost",onClick:s,disabled:o,className:"px-6 py-3",children:"Cancelar"})]})})]})]})}):null},ur=({tasks:e,users:t,user:s,onAdvanceStatus:a,onRegressStatus:r,onDeleteTask:i,onAddComment:l,onSearchChange:n,onStatusFilterChange:o,searchQuery:d,statusFilter:c})=>{const{t:u}=Ya(),[m,h]=qe.useState(!1),[p,x]=qe.useState(null);return Xe.jsxs("div",{className:"max-w-7xl mx-auto space-y-10 animate-in",children:[Xe.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-6",children:[Xe.jsxs("div",{className:"flex gap-4 w-full lg:w-auto",children:[Xe.jsxs("div",{className:"relative flex-1 lg:flex-initial",children:[Xe.jsx("input",{placeholder:u.search,value:d,onChange:e=>n(e.target.value),className:"bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 pl-12 pr-6 py-4 rounded-2xl outline-none focus:ring-4 focus:ring-emerald-500/5 transition-all w-full lg:min-w-[400px] font-bold text-sm shadow-sm"}),Xe.jsx(Sa,{className:"absolute left-4 top-4.5 text-slate-300",size:18})]}),Xe.jsxs("select",{value:c,onChange:e=>o(e.target.value),className:"bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 px-6 py-4 rounded-2xl font-bold text-[10px] uppercase tracking-widest text-slate-500 outline-none cursor-pointer shadow-sm",children:[Xe.jsx("option",{value:"all",children:u.allStatuses}),Object.values(ms).map(e=>Xe.jsx("option",{value:e,children:e},e))]})]}),(null==s?void 0:s.role)===us.ADMIN&&Xe.jsxs(_a,{onClick:()=>{x(null),h(!0)},className:"px-6 sm:px-10 py-4 sm:py-5 rounded-2xl shadow-xl shadow-emerald-500/20 bg-[#10b981] hover:bg-[#059669] transition-colors",children:[Xe.jsx(Aa,{size:18,className:"sm:w-5 sm:h-5"})," ",u.createTask]})]}),Xe.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6 lg:gap-8",children:e.length>0?e.map(e=>Xe.jsx(dr,{task:e,user:s,users:t,onAdvance:()=>a(e),onRegress:r?()=>r(e):void 0,onDelete:()=>i(e),onEdit:(null==s?void 0:s.role)===us.ADMIN?()=>{x(e.id),h(!0)}:void 0,onAddComment:t=>l(e.id,t)},e.id)):Xe.jsxs("div",{className:"col-span-full py-20 text-center space-y-6",children:[Xe.jsx(xa,{size:100,className:"mx-auto text-slate-100 dark:text-slate-800"}),Xe.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-widest",children:u.noTasks})]})}),Xe.jsx(cr,{isOpen:m,editingTaskId:p,onClose:()=>{h(!1),x(null)}})]})},mr=({user:e,currentUser:t,onEdit:s,onDelete:a,onAvatarUpload:r,getAvatarUrl:i})=>{Ya();const l=t.id===e.id,n=t.role===us.ADMIN,o=n&&!l,d=n&&!l,c=e.createdAt?new Date(e.createdAt).toLocaleDateString("pt-PT",{day:"2-digit",month:"2-digit",year:"numeric"}):null,u=e=>e||null;return Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl p-6 border border-slate-100 dark:border-slate-800 shadow-sm hover:shadow-lg transition-all group relative overflow-hidden",children:[e.role===us.ADMIN&&Xe.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-emerald-500/10 rounded-bl-[40px] flex items-center justify-end p-4",children:Xe.jsx(Ta,{size:24,className:"text-emerald-500"})}),l&&Xe.jsx("div",{className:"absolute top-0 left-0 w-20 h-20 bg-blue-500/10 rounded-br-[40px] flex items-center justify-start p-4",children:Xe.jsx(Oa,{size:20,className:"text-blue-500"})}),Xe.jsxs("div",{className:"flex gap-4",children:[Xe.jsxs("button",{type:"button",onClick:()=>n&&r(e.id),className:"flex-shrink-0 w-16 h-16 rounded-xl bg-slate-100 dark:bg-slate-800 flex items-center justify-center overflow-hidden\n            "+(n?"cursor-pointer hover:opacity-80 transition-opacity group relative":"cursor-default"),disabled:!n,title:n?"Clique para alterar avatar":void 0,children:[i(e)?Xe.jsx("img",{src:i(e),alt:e.name,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none",e.target.parentElement.innerHTML+='<div class="w-full h-full flex items-center justify-center"><svg class="w-8 h-8 text-slate-400" ...></div>'}}):Xe.jsx(Ia,{size:32,className:"text-slate-400"}),n&&Xe.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl",children:Xe.jsx("span",{className:"text-white text-xs font-bold",children:"Alterar"})})]}),Xe.jsxs("div",{className:"flex-1 min-w-0",children:[Xe.jsxs("div",{className:"flex items-start justify-between",children:[Xe.jsxs("div",{className:"space-y-1",children:[Xe.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[Xe.jsx("p",{className:"font-black text-slate-900 dark:text-white truncate max-w-[150px]",children:e.name}),l&&Xe.jsx("span",{className:"text-[10px] font-bold text-blue-600 bg-blue-50 dark:bg-blue-900/20 px-2 py-0.5 rounded-full",children:"VocÃª"})]}),Xe.jsx("div",{className:"flex items-center gap-1",children:e.role===us.ADMIN?Xe.jsxs("span",{className:"text-[10px] font-bold text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 px-2 py-0.5 rounded-full flex items-center gap-1",children:[Xe.jsx(Ta,{size:10}),"Administrador"]}):Xe.jsxs("span",{className:"text-[10px] font-bold text-blue-600 bg-blue-50 dark:bg-blue-900/20 px-2 py-0.5 rounded-full flex items-center gap-1",children:[Xe.jsx(Oa,{size:10}),"FuncionÃ¡rio"]})})]}),(o||d)&&Xe.jsxs("div",{className:"flex gap-1 ml-2",children:[o&&Xe.jsx("button",{onClick:()=>s(e.id),className:"p-2 rounded-lg text-slate-400 hover:bg-emerald-50 hover:text-emerald-600 transition-colors",title:"Editar utilizador",children:Xe.jsx(ja,{size:16})}),d&&Xe.jsx("button",{onClick:()=>a(e.id),className:"p-2 rounded-lg text-slate-400 hover:bg-rose-50 hover:text-rose-500 transition-colors",title:"Eliminar utilizador",children:Xe.jsx(Ma,{size:16})})]})]}),Xe.jsxs("div",{className:"flex items-center gap-2 mt-3 text-xs text-slate-500",children:[Xe.jsx(ya,{size:14,className:"flex-shrink-0"}),Xe.jsx("span",{className:"truncate hover:text-slate-700 dark:hover:text-slate-300 transition-colors",title:e.email,children:e.email})]}),u(e.phone)&&Xe.jsxs("div",{className:"flex items-center gap-2 mt-1.5 text-xs text-slate-500",children:[Xe.jsx(Na,{size:14,className:"flex-shrink-0"}),Xe.jsx("span",{className:"truncate",children:u(e.phone)})]}),e.position&&Xe.jsxs("div",{className:"flex items-center gap-2 mt-1.5 text-xs text-slate-500",children:[Xe.jsx(na,{size:14,className:"flex-shrink-0"}),Xe.jsx("span",{className:"truncate",children:e.position})]}),e.department&&Xe.jsx("div",{className:"mt-2",children:Xe.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:e.department})}),c&&Xe.jsx("div",{className:"mt-3 pt-3 border-t border-slate-100 dark:border-slate-800",children:Xe.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-slate-400",children:[Xe.jsx(oa,{size:12}),Xe.jsxs("span",{children:["Membro desde ",c]})]})})]})]})]})},hr=({isOpen:e,onClose:t,onSuccess:s,editingUserId:a,users:r,currentUser:i})=>{Ya();const{createUser:l,updateUser:n}=ir(),[o,d]=qe.useState(!1),[c,u]=qe.useState(null),[m,h]=qe.useState({name:"",email:"",phone:"",position:"",department:"",role:us.EMPLOYEE}),p=a?r.find(e=>e.id===a):null;qe.useEffect(()=>(document.body.style.overflow=e?"hidden":"unset",()=>{document.body.style.overflow="unset"}),[e]),qe.useEffect(()=>{h(p?{name:p.name||"",email:p.email||"",phone:p.phone||"",position:p.position||"",department:p.department||"",role:p.role||us.EMPLOYEE}:{name:"",email:"",phone:"",position:"",department:"",role:us.EMPLOYEE}),u(null)},[p,a]);const x=e=>{const{name:t,value:s}=e.target;h(e=>({...e,[t]:s})),c&&u(null)},f=()=>{o||t()};if(!e)return null;const b=!!a,v=a===i.id;return Xe.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-md z-[100] flex items-start justify-center p-4 overflow-y-auto",onClick:e=>{e.target===e.currentTarget&&f()},style:{position:"fixed",top:0,left:0,right:0,bottom:0,overflowY:"auto",WebkitOverflowScrolling:"touch"},children:Xe.jsx("div",{className:"min-h-full flex items-center justify-center py-6 sm:py-10 w-full",children:Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-2xl p-6 sm:p-8 border border-slate-100 dark:border-slate-800 shadow-2xl relative animate-in my-auto",onClick:e=>e.stopPropagation(),style:{maxHeight:"calc(100vh - 80px)",overflowY:"auto"},children:[Xe.jsx("div",{className:"sticky top-0 bg-white dark:bg-slate-900 pt-0 pb-4 z-10 border-b border-slate-100 dark:border-slate-800 mb-4",children:Xe.jsxs("div",{className:"flex items-center justify-between",children:[Xe.jsxs("div",{className:"flex items-center gap-3",children:[Xe.jsx("div",{className:"p-2 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg",children:b?Xe.jsx(na,{size:20,className:"text-emerald-600"}):Xe.jsx(Ia,{size:20,className:"text-emerald-600"})}),Xe.jsx("h2",{className:"text-xl font-black text-slate-900 dark:text-white",children:b?"Editar Utilizador":"Novo Utilizador"})]}),Xe.jsx("button",{onClick:f,className:"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800",disabled:o,children:Xe.jsx(Fa,{size:20})})]})}),c&&Xe.jsx("div",{className:"mb-6 p-4 bg-rose-50 border border-rose-200 rounded-lg",children:Xe.jsxs("div",{className:"flex items-start gap-3",children:[Xe.jsx(Pa,{className:"text-rose-500 mt-0.5 flex-shrink-0",size:18}),Xe.jsxs("div",{children:[Xe.jsx("h4",{className:"font-bold text-rose-700 text-sm mb-1",children:"Erro de validaÃ§Ã£o"}),Xe.jsx("p",{className:"text-rose-600 text-xs",children:c})]})]})}),Xe.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{if(!m.name.trim())return u("Por favor, preencha o nome."),!1;if(!m.email.trim())return u("Por favor, preencha o email."),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m.email))return u("Por favor, insira um email vÃ¡lido."),!1;if(!a&&r.some(e=>e.email.toLowerCase()===m.email.toLowerCase()))return u("Este email jÃ¡ estÃ¡ cadastrado no sistema."),!1;if(m.phone&&!/^[0-9+\-\s()]{9,}$/.test(m.phone))return u("Por favor, insira um nÃºmero de telefone vÃ¡lido."),!1;return!0})()){d(!0),u(null);try{a?await n(a,{name:m.name,email:m.email,phone:m.phone,position:m.position,department:m.department,role:m.role}):await l(m),s(),t()}catch(i){u(i.message||"Erro ao salvar utilizador. Tente novamente.")}finally{d(!1)}}},className:"space-y-4",children:[Xe.jsxs("div",{children:[Xe.jsxs("label",{className:"block text-[10px] font-black uppercase text-slate-400 tracking-widest mb-1.5",children:["Nome Completo ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsxs("div",{className:"relative",children:[Xe.jsx("input",{type:"text",name:"name",value:m.name,onChange:x,placeholder:"JoÃ£o Silva",className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all font-bold text-sm",disabled:o,required:!0,autoFocus:!0}),Xe.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18})]})]}),Xe.jsxs("div",{children:[Xe.jsxs("label",{className:"block text-[10px] font-black uppercase text-slate-400 tracking-widest mb-1.5",children:["Email ",Xe.jsx("span",{className:"text-rose-500",children:"*"})]}),Xe.jsxs("div",{className:"relative",children:[Xe.jsx("input",{type:"email",name:"email",value:m.email,onChange:x,placeholder:"joao@empresa.com",className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all font-bold text-sm "+(b?"opacity-75 cursor-not-allowed":""),disabled:o||b,required:!0}),Xe.jsx(ya,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18})]}),b&&Xe.jsx("p",{className:"text-[9px] text-amber-600 dark:text-amber-400 mt-1",children:"â ï¸ O email nÃ£o pode ser alterado."})]}),Xe.jsxs("div",{children:[Xe.jsx("label",{className:"block text-[10px] font-black uppercase text-slate-400 tracking-widest mb-1.5",children:"Telefone"}),Xe.jsxs("div",{className:"relative",children:[Xe.jsx("input",{type:"tel",name:"phone",value:m.phone,onChange:x,placeholder:"+244 999 999 999",className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all font-bold text-sm",disabled:o}),Xe.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18})]})]}),Xe.jsxs("div",{children:[Xe.jsx("label",{className:"block text-[10px] font-black uppercase text-slate-400 tracking-widest mb-1.5",children:"Cargo / PosiÃ§Ã£o"}),Xe.jsxs("div",{className:"relative",children:[Xe.jsx("input",{type:"text",name:"position",value:m.position,onChange:x,placeholder:"Desenvolvedor Senior",className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all font-bold text-sm",disabled:o}),Xe.jsx(na,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18})]})]}),Xe.jsxs("div",{children:[Xe.jsx("label",{className:"block text-[10px] font-black uppercase text-slate-400 tracking-widest mb-1.5",children:"Departamento"}),Xe.jsx("input",{type:"text",name:"department",value:m.department,onChange:x,placeholder:"Tecnologia",className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all font-bold text-sm",disabled:o})]}),Xe.jsxs("div",{children:[Xe.jsx("label",{className:"block text-[10px] font-black uppercase text-slate-400 tracking-widest mb-1.5",children:"Perfil de Acesso"}),Xe.jsxs("div",{className:"relative",children:[Xe.jsxs("select",{name:"role",value:m.role,onChange:x,className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all font-bold text-sm appearance-none "+(v?"opacity-75 cursor-not-allowed":"cursor-pointer"),disabled:o||v,children:[Xe.jsx("option",{value:us.EMPLOYEE,children:"FuncionÃ¡rio"}),Xe.jsx("option",{value:us.ADMIN,children:"Administrador"})]}),Xe.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:m.role===us.ADMIN?Xe.jsx(Ta,{size:16,className:"text-emerald-500"}):Xe.jsx(Oa,{size:16,className:"text-blue-500"})})]}),v&&Xe.jsxs("p",{className:"text-[9px] text-amber-600 dark:text-amber-400 mt-1 flex items-center gap-1",children:[Xe.jsx(Pa,{size:10}),"NÃ£o pode alterar seu prÃ³prio perfil."]})]}),!b&&Xe.jsx("div",{className:"p-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg border border-emerald-100 dark:border-emerald-800",children:Xe.jsxs("p",{className:"text-[10px] text-emerald-700 dark:text-emerald-400 flex items-start gap-2",children:[Xe.jsx(Ta,{size:14,className:"flex-shrink-0 mt-0.5"}),Xe.jsxs("span",{children:[Xe.jsx("span",{className:"font-bold",children:"Nota:"})," Uma senha temporÃ¡ria serÃ¡ gerada automaticamente e enviada por email para o utilizador."]})]})}),b&&!v&&Xe.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-800",children:Xe.jsxs("p",{className:"text-[9px] text-blue-700 dark:text-blue-400 flex items-center gap-2",children:[Xe.jsx(na,{size:12}),"A editar utilizador: ",Xe.jsx("span",{className:"font-bold",children:null==p?void 0:p.name})]})}),Xe.jsx("div",{className:"sticky bottom-0 bg-white dark:bg-slate-900 pt-4 pb-0 border-t border-slate-100 dark:border-slate-800 mt-6",children:Xe.jsxs("div",{className:"flex gap-3",children:[Xe.jsx(_a,{type:"submit",disabled:o,className:"flex-1",children:o?Xe.jsxs(Xe.Fragment,{children:[Xe.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),b?"A guardar...":"A criar..."]}):b?"Guardar AlteraÃ§Ãµes":"Criar Utilizador"}),Xe.jsx(_a,{type:"button",variant:"ghost",onClick:f,disabled:o,children:"Cancelar"})]})})]})]})})})},pr=({size:e="md",color:t="emerald",fullScreen:s=!1,text:a="Carregando..."})=>{const r=Xe.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[Xe.jsx("div",{className:`${{sm:"w-5 h-5 border-2",md:"w-8 h-8 border-3",lg:"w-12 h-12 border-4"}[e]} ${{emerald:"border-emerald-500 border-t-transparent",blue:"border-blue-500 border-t-transparent",slate:"border-slate-500 border-t-transparent"}[t]} rounded-full animate-spin`,role:"status","aria-label":"loading"}),a&&Xe.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:a})]});return s?Xe.jsx("div",{className:"fixed inset-0 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center",children:r}):r},xr=({children:e,isLoading:t})=>t?Xe.jsxs("div",{className:"relative",children:[Xe.jsx("div",{className:"absolute inset-0 bg-white/60 dark:bg-slate-900/60 backdrop-blur-sm z-10 flex items-center justify-center rounded-lg",children:Xe.jsx(pr,{size:"sm"})}),Xe.jsx("div",{className:"opacity-50 pointer-events-none",children:e})]}):Xe.jsx(Xe.Fragment,{children:e}),fr=({users:e,currentUser:t,onUpdateUser:s,onDeleteUser:a,onAvatarUpload:r,getAvatarUrl:i})=>{Ya();const[l,n]=qe.useState(""),[o,d]=qe.useState("all"),[c,u]=qe.useState(!1),[m,h]=qe.useState(null),[p,x]=qe.useState(!1),f=qe.useMemo(()=>e.filter(e=>{const t=""===l||e.name.toLowerCase().includes(l.toLowerCase())||e.email.toLowerCase().includes(l.toLowerCase())||e.position&&e.position.toLowerCase().includes(l.toLowerCase()),s="all"===o||e.role===o;return t&&s}),[e,l,o]),b=qe.useMemo(()=>[...f].sort((e,t)=>e.role===us.ADMIN&&t.role!==us.ADMIN?-1:e.role!==us.ADMIN&&t.role===us.ADMIN?1:e.name.localeCompare(t.name)),[f]),v=qe.useMemo(()=>({total:e.length,admins:e.filter(e=>e.role===us.ADMIN).length,employees:e.filter(e=>e.role===us.EMPLOYEE).length}),[e]),g=e=>{h(e)},y=()=>{h(null)},k=()=>{u(!1)};return p?Xe.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:Xe.jsx(pr,{size:"lg",text:"Carregando utilizadores..."})}):Xe.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 sm:space-y-10 animate-in",children:[Xe.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[Xe.jsxs("div",{children:[Xe.jsx("h3",{className:"text-lg font-black text-slate-900 dark:text-white",children:"GestÃ£o de Utilizadores"}),Xe.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:["Total: ",v.total," utilizadores (",v.admins," admin, ",v.employees," funcionÃ¡rios)"]})]}),Xe.jsxs(_a,{onClick:()=>u(!0),className:"px-6 py-3",children:[Xe.jsx(Aa,{size:18,className:"mr-2"})," Adicionar Utilizador"]})]}),Xe.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-2xl p-4 border border-slate-100 dark:border-slate-800 shadow-sm",children:Xe.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[Xe.jsxs("div",{className:"relative flex-1",children:[Xe.jsx("input",{placeholder:"Pesquisar por nome, email ou cargo...",value:l,onChange:e=>n(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all font-medium text-sm"}),Xe.jsx(Sa,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18})]}),Xe.jsxs("div",{className:"relative min-w-[200px]",children:[Xe.jsxs("select",{value:o,onChange:e=>d(e.target.value),className:"w-full px-4 py-3 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 appearance-none cursor-pointer font-medium text-sm",children:[Xe.jsx("option",{value:"all",children:"Todos os perfis"}),Xe.jsx("option",{value:us.ADMIN,children:"Administradores"}),Xe.jsx("option",{value:us.EMPLOYEE,children:"FuncionÃ¡rios"})]}),Xe.jsx(ua,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none",size:18})]})]})}),Xe.jsx(xr,{isLoading:p,children:b.length>0?Xe.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:b.map(e=>Xe.jsx(mr,{user:e,currentUser:t,onEdit:g,onDelete:a,onAvatarUpload:r,getAvatarUrl:i},e.id))}):Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl p-12 text-center border border-slate-100 dark:border-slate-800",children:[Xe.jsx("div",{className:"w-20 h-20 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-4",children:Xe.jsx(Ua,{size:32,className:"text-slate-400"})}),Xe.jsx("h4",{className:"text-lg font-bold text-slate-900 dark:text-white mb-2",children:"Nenhum utilizador encontrado"}),Xe.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6",children:l||"all"!==o?"Tente ajustar os filtros de pesquisa.":'Clique no botÃ£o "Adicionar Utilizador" para comeÃ§ar.'}),!l&&"all"===o&&Xe.jsxs(_a,{onClick:()=>u(!0),children:[Xe.jsx(Aa,{size:18})," Adicionar Utilizador"]})]})}),c&&Xe.jsx(hr,{isOpen:c,onClose:k,onSuccess:()=>{k()},users:e,currentUser:t}),m&&Xe.jsx(hr,{isOpen:!!m,onClose:y,editingUserId:m,onSuccess:y,users:e,currentUser:t})]})},br={emerald:"bg-emerald-50 dark:bg-emerald-900/10",rose:"bg-rose-50 dark:bg-rose-900/10"},vr=({icon:e,label:t,value:s,color:a})=>Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 p-8 rounded-[3.5rem] border border-slate-100 dark:border-slate-800 shadow-sm flex items-center gap-8 group hover:shadow-xl transition-all",children:[Xe.jsx("div",{className:`w-20 h-20 rounded-[2.2rem] flex items-center justify-center ${br[a]||"bg-slate-50"} group-hover:scale-110 transition-transform`,children:e}),Xe.jsxs("div",{children:[Xe.jsx("p",{className:"text-[10px] font-black uppercase text-slate-400 tracking-widest",children:t}),Xe.jsx("p",{className:"text-4xl font-black text-slate-900 dark:text-white tracking-tighter mt-1",children:s})]})]}),gr=({stats:e,tasks:t,users:s,visibleActivities:a,user:r})=>{const{t:i}=Ya(),l=Object.values(ms).map(e=>({status:e,count:t.filter(t=>t.status===e).length}));return Xe.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 sm:space-y-12 animate-in",children:[Xe.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6 lg:gap-8",children:[Xe.jsx(vr,{icon:Xe.jsx(fa,{className:"text-emerald-600"}),label:i.activeTasks,value:e.active,color:"emerald"}),Xe.jsx(vr,{icon:Xe.jsx(Pa,{className:"text-rose-600"}),label:i.overdueTasks,value:e.overdue,color:"rose"}),Xe.jsx(vr,{icon:Xe.jsx(ha,{className:"text-emerald-600"}),label:i.completedTasks,value:e.completed,color:"emerald"})]}),Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl sm:rounded-[3rem] p-6 sm:p-8 lg:p-10 border border-slate-100 dark:border-slate-800 shadow-sm",children:[Xe.jsx("h3",{className:"text-base sm:text-lg font-black mb-6 tracking-tight",children:i.tasksByStatus||"Tarefas por Estado"}),Xe.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3 sm:gap-4",children:l.map(({status:e,count:t})=>Xe.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 rounded-xl p-3 sm:p-4 text-center",children:[Xe.jsx("p",{className:"text-2xl sm:text-3xl font-black text-slate-900 dark:text-white",children:t}),Xe.jsx("p",{className:"text-[10px] sm:text-xs font-bold text-slate-500 uppercase mt-1 line-clamp-2",children:e})]},e))})]}),Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl sm:rounded-[3rem] p-6 sm:p-8 lg:p-12 border border-slate-100 dark:border-slate-800 shadow-sm",children:[Xe.jsx("h3",{className:"text-base sm:text-lg font-black mb-6 sm:mb-10 tracking-tight",children:i.latestUpdates}),Xe.jsxs("div",{className:"space-y-4 sm:space-y-6 max-h-[420px] overflow-y-auto pr-2",children:[a.slice(0,15).map(e=>Xe.jsx(yr,{activity:e},e.id)),0===a.length&&Xe.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-widest text-center py-10",children:i.noActivities})]})]}),Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl sm:rounded-[3rem] p-6 sm:p-8 lg:p-12 border border-slate-100 dark:border-slate-800 shadow-sm",children:[Xe.jsx("h3",{className:"text-base sm:text-lg font-black mb-6 sm:mb-10 tracking-tight",children:i.activityLog}),Xe.jsxs("div",{className:"space-y-3 max-h-[420px] overflow-y-auto pr-2",children:[a.map(e=>Xe.jsx(kr,{activity:e},`log-${e.id}`)),0===a.length&&Xe.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-widest text-center py-10",children:i.noActivities})]})]})]})},yr=({activity:e})=>{const t=t=>e.userName||t;return Xe.jsxs("div",{className:"flex gap-3 sm:gap-6 items-start border-b border-slate-50 dark:border-slate-800 pb-4 last:border-0",children:[Xe.jsx("div",{className:"p-2.5 sm:p-4 rounded-xl shrink-0 bg-emerald-50 dark:bg-emerald-900/20 text-[#10b981]",children:Xe.jsx(la,{size:18,className:"sm:w-5 sm:h-5"})}),Xe.jsxs("div",{className:"flex-1 min-w-0",children:[Xe.jsxs("p",{className:"font-bold text-slate-700 dark:text-slate-300 text-sm sm:text-base",children:["created"===e.action&&Xe.jsxs(Xe.Fragment,{children:[Xe.jsx("span",{className:"text-[#10b981]",children:t(e.userId)})," criou a tarefa Â«",e.entityTitle,"Â»"]}),"updated"===e.action&&Xe.jsxs(Xe.Fragment,{children:[Xe.jsx("span",{className:"text-[#10b981]",children:t(e.userId)})," editou a tarefa Â«",e.entityTitle,"Â»"]}),"deleted"===e.action&&Xe.jsxs(Xe.Fragment,{children:[Xe.jsx("span",{className:"text-rose-600",children:t(e.userId)})," eliminou a tarefa Â«",e.entityTitle,"Â»"]}),"status_changed"===e.action&&Xe.jsxs(Xe.Fragment,{children:[Xe.jsx("span",{className:"text-[#10b981]",children:t(e.userId)})," alterou Â«",e.entityTitle,"Â» de ",e.fromStatus," â ",e.toStatus]}),"commented"===e.action&&Xe.jsxs(Xe.Fragment,{children:[Xe.jsx("span",{className:"text-[#10b981]",children:t(e.userId)})," comentou em Â«",e.entityTitle,"Â»"]})]}),Xe.jsx("p",{className:"text-[10px] font-black uppercase text-slate-400 mt-1",children:new Date(e.timestamp).toLocaleString()})]})]})},kr=({activity:e})=>Xe.jsxs("div",{className:"px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800/50 text-xs",children:[Xe.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-300",children:new Date(e.timestamp).toLocaleString("pt-PT")}),Xe.jsx("span",{className:"mx-2 text-slate-400",children:"â¢"}),Xe.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:e.userName}),Xe.jsx("span",{className:"mx-2 text-slate-400",children:"â¢"}),Xe.jsx("span",{className:"text-slate-500",children:e.action}),Xe.jsx("span",{className:"mx-2 text-slate-400",children:"â¢"}),Xe.jsx("span",{className:"text-slate-700 dark:text-slate-200",children:e.entityTitle||e.entityId}),e.fromStatus&&e.toStatus&&Xe.jsxs(Xe.Fragment,{children:[Xe.jsx("span",{className:"mx-2 text-slate-400",children:"â¢"}),Xe.jsxs("span",{className:"text-slate-500",children:[e.fromStatus," â ",e.toStatus]})]})]}),wr=({user:e,users:t,setUsers:s,setUser:a,profilePassword:r,setProfilePassword:i,profilePasswordConfirm:l,setProfilePasswordConfirm:n,profilePasswordError:o,setProfilePasswordError:d,profilePasswordSuccess:c,setProfilePasswordSuccess:u,setActiveTabSafe:m,onAvatarUpload:h,getAvatarUrl:p,updateUser:x,addNotification:f})=>{const{t:b}=Ya(),[v,g]=qe.useState(!1),[y,k]=qe.useState({});return Xe.jsxs("div",{className:"max-w-2xl mx-auto space-y-8 animate-in",children:[Xe.jsxs("div",{className:"flex items-center justify-between",children:[Xe.jsx("h3",{className:"text-lg font-black text-slate-900 dark:text-white",children:b.myProfile}),!v&&!e.mustChangePassword&&Xe.jsxs("button",{onClick:()=>{k({name:e.name,email:e.email,position:e.position,department:e.department,role:e.role}),g(!0)},className:"flex items-center gap-2 px-4 py-2 text-sm font-bold text-emerald-600 hover:text-emerald-700 dark:text-emerald-400 dark:hover:text-emerald-300 transition-colors",children:[Xe.jsx(ja,{size:16}),"Editar Perfil"]})]}),Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl p-6 sm:p-8 border border-slate-100 dark:border-slate-800 shadow-sm",children:[(null==e?void 0:e.mustChangePassword)&&Xe.jsx("div",{className:"mb-6 p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:Xe.jsxs("div",{className:"flex items-start gap-3",children:[Xe.jsx(Pa,{className:"text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0",size:18}),Xe.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-300",children:"Por seguranÃ§a, altere sua senha para continuar."})]})}),Xe.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 mb-8",children:[Xe.jsxs("button",{type:"button",onClick:()=>h(e.id),className:"flex-shrink-0 w-24 h-24 rounded-2xl bg-slate-100 dark:bg-slate-800 flex items-center justify-center overflow-hidden self-center sm:self-start hover:opacity-80 transition-opacity group relative",title:"Clique para alterar avatar",children:[p(e)?Xe.jsx("img",{src:p(e),alt:e.name,className:"w-full h-full object-cover",onError:e=>{const t=e.target;t.style.display="none",t.parentElement.innerHTML+='<div class="w-full h-full flex items-center justify-center"><svg class="w-8 h-8 text-slate-400" ...></div>'}}):Xe.jsx(Ia,{size:40,className:"text-slate-400"}),Xe.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl",children:Xe.jsx("span",{className:"text-white text-xs font-bold",children:"Alterar"})})]}),Xe.jsx("div",{className:"flex-1",children:v?Xe.jsxs("form",{onSubmit:async t=>{t.preventDefault();const s=new FormData(t.target),r={name:s.get("name"),email:s.get("email")};e.role===us.ADMIN&&(r.position=s.get("position"),r.department=s.get("department"),r.role=s.get("role")||e.role);try{if(e.role!==us.ADMIN&&r.email!==e.email)return void f(e.id,"O email sÃ³ pode ser alterado por um administrador.","error");await x(e.id,r);const t={...e,...r};a(t),f(e.id,"Perfil atualizado com sucesso.","success"),g(!1)}catch(i){Ws.warn("User","Erro ao atualizar perfil na API",i),f(e.id,"NÃ£o foi possÃ­vel atualizar o perfil na API.","error")}},className:"space-y-4",children:[Xe.jsxs("div",{children:[Xe.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 dark:text-slate-500 block mb-1",children:b.name}),Xe.jsx("input",{name:"name",defaultValue:e.name,className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-bold text-sm",required:!0})]}),Xe.jsxs("div",{children:[Xe.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 dark:text-slate-500 block mb-1",children:b.email}),Xe.jsx("input",{name:"email",type:"email",defaultValue:e.email,className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-bold text-sm",required:!0,disabled:e.role!==us.ADMIN}),e.role!==us.ADMIN&&Xe.jsx("p",{className:"text-[10px] text-slate-400 dark:text-slate-500 mt-1",children:"Contacte um administrador para alterar o email."})]}),e.role===us.ADMIN&&Xe.jsxs(Xe.Fragment,{children:[Xe.jsxs("div",{children:[Xe.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 dark:text-slate-500 block mb-1",children:b.position}),Xe.jsx("input",{name:"position",defaultValue:e.position,className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-bold text-sm"})]}),Xe.jsxs("div",{children:[Xe.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 dark:text-slate-500 block mb-1",children:b.department}),Xe.jsx("input",{name:"department",defaultValue:e.department,className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-bold text-sm"})]}),Xe.jsxs("div",{children:[Xe.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 dark:text-slate-500 block mb-1",children:"FunÃ§Ã£o"}),Xe.jsxs("select",{name:"role",defaultValue:e.role,className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-bold text-sm appearance-none",children:[Xe.jsx("option",{value:us.EMPLOYEE,children:"FuncionÃ¡rio"}),Xe.jsx("option",{value:us.ADMIN,children:"Administrador"})]})]})]}),Xe.jsxs("div",{className:"flex gap-3 mt-6",children:[Xe.jsx(_a,{type:"submit",className:"flex-1",children:b.save}),Xe.jsx(_a,{type:"button",variant:"ghost",onClick:()=>g(!1),children:b.cancel})]})]}):Xe.jsxs("div",{className:"space-y-4",children:[Xe.jsxs("div",{children:[Xe.jsx("p",{className:"text-[10px] font-black uppercase text-slate-400 dark:text-slate-500",children:b.name}),Xe.jsx("p",{className:"font-bold text-slate-900 dark:text-white text-lg",children:e.name})]}),Xe.jsxs("div",{children:[Xe.jsx("p",{className:"text-[10px] font-black uppercase text-slate-400 dark:text-slate-500",children:b.email}),Xe.jsx("p",{className:"font-bold text-slate-900 dark:text-white",children:e.email})]}),e.position&&Xe.jsxs("div",{children:[Xe.jsx("p",{className:"text-[10px] font-black uppercase text-slate-400 dark:text-slate-500",children:b.position}),Xe.jsx("p",{className:"font-bold text-slate-900 dark:text-white",children:e.position})]}),e.department&&Xe.jsxs("div",{children:[Xe.jsx("p",{className:"text-[10px] font-black uppercase text-slate-400 dark:text-slate-500",children:b.department}),Xe.jsx("p",{className:"font-bold text-slate-900 dark:text-white",children:e.department})]}),Xe.jsxs("div",{children:[Xe.jsx("p",{className:"text-[10px] font-black uppercase text-slate-400 dark:text-slate-500",children:"FunÃ§Ã£o"}),Xe.jsx("p",{className:"font-bold text-[#10b981] uppercase text-sm",children:e.role===us.ADMIN?"Administrador":"FuncionÃ¡rio"})]})]})})]})]}),Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl p-6 sm:p-8 border border-slate-100 dark:border-slate-800 shadow-sm",children:[Xe.jsx("h4",{className:"text-base font-black mb-4 text-slate-900 dark:text-white",children:"Alterar Senha"}),o&&Xe.jsx("div",{className:"mb-4 p-4 bg-rose-50 dark:bg-rose-900/20 border border-rose-200 dark:border-rose-800 rounded-lg",children:Xe.jsxs("div",{className:"flex items-start gap-3",children:[Xe.jsx(Pa,{className:"text-rose-600 dark:text-rose-400 mt-0.5 flex-shrink-0",size:18}),Xe.jsx("p",{className:"text-sm text-rose-700 dark:text-rose-300",children:o})]})}),c&&Xe.jsx("div",{className:"mb-4 p-4 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded-lg",children:Xe.jsxs("div",{className:"flex items-start gap-3",children:[Xe.jsx(ha,{className:"text-emerald-600 dark:text-emerald-400 mt-0.5 flex-shrink-0",size:18}),Xe.jsx("p",{className:"text-sm text-emerald-700 dark:text-emerald-300",children:c})]})}),Xe.jsxs("form",{onSubmit:async o=>{if(o.preventDefault(),d(null),u(null),r.trim())if(r.trim().length<6)d("A senha deve ter pelo menos 6 caracteres.");else if(r===l)try{await Fs(e.id,r);const l={...e,mustChangePassword:!1};a(l),s&&s(t.map(t=>t.id===e.id?l:t)),i(""),n(""),u("Senha atualizada com sucesso."),e.mustChangePassword&&setTimeout(()=>m("dashboard"),2e3)}catch(c){Ws.warn("User","Erro ao atualizar senha na API",c),d("NÃ£o foi possÃ­vel atualizar a senha na API.")}else d("As senhas nÃ£o coincidem.");else d("Preencha a nova senha.")},className:"space-y-4",children:[Xe.jsxs("div",{children:[Xe.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 dark:text-slate-500 block mb-1",children:"Nova senha"}),Xe.jsxs("div",{className:"relative",children:[Xe.jsx("input",{value:r,onChange:e=>i(e.target.value),type:"password",className:"w-full pl-10 pr-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-bold text-sm",placeholder:"MÃ­nimo 6 caracteres"}),Xe.jsx(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:16})]})]}),Xe.jsxs("div",{children:[Xe.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 dark:text-slate-500 block mb-1",children:"Confirmar senha"}),Xe.jsxs("div",{className:"relative",children:[Xe.jsx("input",{value:l,onChange:e=>n(e.target.value),type:"password",className:"w-full pl-10 pr-4 py-3 rounded-xl bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 outline-none transition-all font-bold text-sm",placeholder:"Repita a senha"}),Xe.jsx(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:16})]})]}),Xe.jsx("div",{className:"flex gap-3 mt-6",children:Xe.jsx(_a,{type:"submit",className:"flex-1",children:"Atualizar senha"})})]})]})]})},jr=({tasks:e,users:t})=>{const{t:s}=Ya(),a=t.filter(e=>e.role===us.EMPLOYEE||e.role===us.ADMIN).map(t=>{const s=e.filter(e=>{var s;return e.responsibleId===t.id||(null==(s=e.intervenientes)?void 0:s.includes(t.id))}),a=s.length,r=s.filter(e=>e.status===ms.FECHADO).length,i=s.filter(e=>e.status===ms.ATRASADA).length,l=a?Math.round(r/a*100):0;return{...t,total:a,completed:r,overdue:i,complianceRate:l}}).sort((e,t)=>t.complianceRate-e.complianceRate);return Xe.jsxs("div",{className:"max-w-7xl mx-auto space-y-6 sm:space-y-10 animate-in",children:[Xe.jsx("h3",{className:"text-lg font-black",children:s.employeeReport}),Xe.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-2xl sm:rounded-3xl border border-slate-100 dark:border-slate-800 shadow-sm overflow-x-auto",children:Xe.jsxs("table",{className:"w-full min-w-[640px] text-left",children:[Xe.jsx("thead",{children:Xe.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-800",children:[Xe.jsx("th",{className:"px-4 sm:px-6 py-4 text-[10px] font-black uppercase text-slate-400 tracking-widest",children:s.employee}),Xe.jsx("th",{className:"px-4 sm:px-6 py-4 text-[10px] font-black uppercase text-slate-400 tracking-widest text-center",children:s.total}),Xe.jsx("th",{className:"px-4 sm:px-6 py-4 text-[10px] font-black uppercase text-slate-400 tracking-widest text-center",children:s.completed}),Xe.jsx("th",{className:"px-4 sm:px-6 py-4 text-[10px] font-black uppercase text-slate-400 tracking-widest text-center",children:s.overdue}),Xe.jsx("th",{className:"px-4 sm:px-6 py-4 text-[10px] font-black uppercase text-slate-400 tracking-widest text-center",children:s.complianceRate})]})}),Xe.jsx("tbody",{children:a.map(e=>Xe.jsxs("tr",{className:"border-b border-slate-50 dark:border-slate-800/50 hover:bg-slate-50/50 dark:hover:bg-slate-800/30",children:[Xe.jsx("td",{className:"px-4 sm:px-6 py-4 font-bold text-slate-900 dark:text-white",children:e.name}),Xe.jsx("td",{className:"px-4 sm:px-6 py-4 text-center font-black",children:e.total}),Xe.jsx("td",{className:"px-4 sm:px-6 py-4 text-center text-[#10b981] font-bold",children:e.completed}),Xe.jsx("td",{className:"px-4 sm:px-6 py-4 text-center text-rose-500 font-bold",children:e.overdue}),Xe.jsxs("td",{className:"px-4 sm:px-6 py-4 text-center",children:[Xe.jsxs("span",{className:"font-black "+(e.complianceRate>=70?"text-emerald-600":e.complianceRate>=40?"text-amber-600":"text-rose-600"),children:[e.complianceRate,"%"]}),Xe.jsx("div",{className:"w-full bg-slate-200 rounded-full h-1.5 mt-2",children:Xe.jsx("div",{className:"h-1.5 rounded-full "+(e.complianceRate>=70?"bg-emerald-600":e.complianceRate>=40?"bg-amber-600":"bg-rose-600"),style:{width:`${e.complianceRate}%`}})})]})]},e.id))})]})}),Xe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl p-6 border border-slate-100 dark:border-slate-800",children:[Xe.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider mb-2",children:"Total de Tarefas"}),Xe.jsx("p",{className:"text-3xl font-black text-slate-900 dark:text-white",children:e.length})]}),Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl p-6 border border-slate-100 dark:border-slate-800",children:[Xe.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider mb-2",children:"Taxa de ConclusÃ£o"}),Xe.jsxs("p",{className:"text-3xl font-black text-emerald-600",children:[e.length?Math.round(e.filter(e=>e.status===ms.FECHADO).length/e.length*100):0,"%"]})]}),Xe.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl p-6 border border-slate-100 dark:border-slate-800",children:[Xe.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider mb-2",children:"FuncionÃ¡rios Ativos"}),Xe.jsx("p",{className:"text-3xl font-black text-slate-900 dark:text-white",children:t.filter(e=>e.role===us.EMPLOYEE).length})]})]})]})},Nr=()=>{qe.useContext(Ys);const{user:e,setUser:t,logout:s}=La(),{tasks:a,filteredTasks:r,filterTasks:i,handleAdvanceStatus:l,handleRegressStatus:n,handleDeleteTask:o,addComment:d}=Ja(),{users:c,getAvatarUrl:u,saveAvatar:m,updateUser:h,deleteUser:p}=ir(),{notifications:x,markAllNotificationsAsRead:f,addNotification:b}=(()=>{const e=qe.useContext(Ys);if(!e)throw new Error("useNotifications must be used within AppProvider");return{notifications:e.notifications,setNotifications:e.setNotifications,addNotification:e.addNotification,markAllNotificationsAsRead:e.markAllNotificationsAsRead}})(),{visibleActivities:v}=(()=>{const e=qe.useContext(Ys);if(!e)throw new Error("useActivities must be used within AppProvider");const t=qe.useMemo(()=>{if(!e.user)return[];if(e.user.role===us.ADMIN)return e.systemActivities;const t=new Set(e.tasks.filter(t=>{var s,a,r;return t.responsibleId===(null==(s=e.user)?void 0:s.id)||(null==(r=t.intervenientes)?void 0:r.includes(null==(a=e.user)?void 0:a.id))}).map(e=>e.id));return e.systemActivities.filter(e=>t.has(e.entityId))},[e.systemActivities,e.tasks,e.user]);return{systemActivities:e.systemActivities,setSystemActivities:e.setSystemActivities,addSystemActivity:e.addSystemActivity,visibleActivities:t}})(),{activeTab:g,setActiveTab:y,setView:k}=qa(),{lang:w,setLang:j,t:N}=Ya(),{theme:A,setTheme:S}=(()=>{const e=qe.useContext(Ys);if(!e)throw new Error("useTheme must be used within AppProvider");return{theme:e.theme,setTheme:e.setTheme}})(),E=qe.useRef(null),[T,C]=qe.useState(!1),[O,D]=qe.useState(!1),[M,P]=qe.useState(!1),[R,I]=qe.useState(null),[U,z]=qe.useState(""),[F,L]=qe.useState(""),[q,$]=qe.useState(null),[_,W]=qe.useState(null),[Q,V]=qe.useState(""),[G,H]=qe.useState("all");if(!e)return Xe.jsx("div",{children:"Carregando..."});const K=t=>{(null==e?void 0:e.mustChangePassword)&&"profile"!==t?y("profile"):y(t)},Y=e=>{I(e),setTimeout(()=>{var e;return null==(e=E.current)?void 0:e.click()},0)},B={active:a.filter(e=>e.status!==ms.FECHADO&&e.status!==ms.ARQUIVADO&&e.status!==ms.CANCELADA).length,overdue:a.filter(e=>e.status===ms.ATRASADA).length,completed:a.filter(e=>e.status===ms.FECHADO).length};return Xe.jsxs("div",{className:"h-screen flex bg-[#f8fafc] dark:bg-slate-950 transition-all font-sans overflow-hidden",children:[Xe.jsx("input",{ref:E,type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(s&&R){const e=new FileReader;e.onload=()=>{m(R,e.result),I(null)},e.readAsDataURL(s)}e.target.value=""}}),O&&Xe.jsx("div",{className:"fixed inset-0 bg-slate-900/40 z-[75] lg:hidden",onClick:()=>D(!1),"aria-hidden":"true"}),Xe.jsxs("aside",{className:`fixed lg:relative left-0 top-0 h-screen flex flex-col z-[80] transition-all duration-300 ease-in-out\n        bg-white dark:bg-slate-900 border-r border-slate-200 dark:border-slate-800\n        ${O?"translate-x-0":"-translate-x-full lg:translate-x-0"}\n        ${T?"lg:w-[100px] w-[280px]":"w-[280px]"}`,children:[Xe.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 flex items-center justify-between",children:[Xe.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>k("landing"),children:[Xe.jsx("div",{className:"bg-[#10b981] p-2 rounded-xl flex-shrink-0 shadow-lg shadow-emerald-500/20",children:Xe.jsx(za,{size:22,className:"text-white"})}),!T&&Xe.jsx("span",{className:"text-xl font-black text-slate-800 dark:text-white uppercase tracking-tighter",children:"GESTORA"})]}),Xe.jsx("button",{onClick:()=>D(!1),className:"lg:hidden p-2 text-slate-400 hover:text-slate-600",children:Xe.jsx(Fa,{size:20})})]}),Xe.jsxs("nav",{className:"flex-1 px-4 space-y-2 mt-4 overflow-y-auto",children:[Xe.jsx(lr,{icon:Xe.jsx(ba,{size:20}),label:N.dashboard,active:"dashboard"===g,collapsed:T,onClick:()=>{K("dashboard"),D(!1)}}),Xe.jsx(lr,{icon:Xe.jsx(Ca,{size:20}),label:N.tasks,active:"tasks"===g,collapsed:T,onClick:()=>{K("tasks"),D(!1)}}),(null==e?void 0:e.role)===us.ADMIN&&Xe.jsxs(Xe.Fragment,{children:[Xe.jsx(lr,{icon:Xe.jsx(Ua,{size:20}),label:N.users,active:"users"===g,collapsed:T,onClick:()=>{K("users"),D(!1)}}),Xe.jsx(lr,{icon:Xe.jsx(da,{size:20}),label:N.reports,active:"reports"===g,collapsed:T,onClick:()=>{K("reports"),D(!1)}})]}),Xe.jsx(lr,{icon:Xe.jsx(Ia,{size:20}),label:N.profile,active:"profile"===g,collapsed:T,onClick:()=>{K("profile"),D(!1)}})]}),Xe.jsx("div",{className:"p-4 lg:p-6 border-t border-slate-100 dark:border-slate-800",children:Xe.jsxs("button",{onClick:s,className:"flex items-center gap-5 w-full px-5 py-4 text-slate-400 hover:text-rose-500 transition-all",children:[Xe.jsx(ga,{size:20}),!T&&Xe.jsx("span",{className:"text-[11px] font-black uppercase tracking-widest",children:N.logout})]})})]}),Xe.jsxs("main",{className:"flex-1 flex flex-col h-screen overflow-hidden relative",children:[Xe.jsxs("header",{className:"h-20 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 px-10 flex items-center justify-between z-50",children:[Xe.jsxs("div",{className:"flex items-center gap-3 sm:gap-6",children:[Xe.jsx("button",{onClick:()=>D(!0),className:"lg:hidden p-3 bg-emerald-50 dark:bg-emerald-900/20 text-[#10b981] rounded-xl",children:Xe.jsx(ka,{size:22})}),Xe.jsx("button",{onClick:()=>C(!T),className:"hidden lg:flex p-3 bg-emerald-50 dark:bg-emerald-900/20 text-[#10b981] rounded-xl",children:Xe.jsx(pa,{size:22,className:"transition-transform duration-500 "+(T?"rotate-180":"")})}),Xe.jsxs("div",{children:[Xe.jsx("h2",{className:"text-lg font-black text-slate-900 dark:text-white leading-none capitalize tracking-tight",children:N[g]||g}),Xe.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1",children:"Gestora Enterprise Workspace"})]})]}),Xe.jsxs("div",{className:"flex items-center gap-6",children:[Xe.jsx("button",{onClick:()=>j("pt"===w?"en":"pt"),className:"text-[10px] font-black p-2 bg-slate-50 dark:bg-slate-800 rounded-lg uppercase tracking-widest",children:w}),Xe.jsx("button",{onClick:()=>S("light"===A?"dark":"light"),className:"p-3 text-slate-400",children:"light"===A?Xe.jsx(wa,{size:20}):Xe.jsx(Da,{size:20})}),Xe.jsxs("div",{className:"relative",children:[Xe.jsxs("button",{onClick:()=>P(!M),className:"p-3 text-slate-400 relative","aria-label":"NotificaÃ§Ãµes",children:[Xe.jsx(la,{size:20}),x.filter(t=>t.userId===(null==e?void 0:e.id)&&!t.isRead).length>0&&Xe.jsx("span",{className:"absolute -top-0.5 -right-0.5 bg-rose-500 text-white text-[9px] font-bold rounded-full h-4 min-w-[16px] px-1 flex items-center justify-center",children:x.filter(t=>t.userId===(null==e?void 0:e.id)&&!t.isRead).length})]}),M&&Xe.jsxs("div",{className:"absolute right-0 mt-2 w-80 max-h-[380px] overflow-y-auto bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl shadow-2xl z-[120]",children:[Xe.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-100 dark:border-slate-800",children:[Xe.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-slate-500",children:N.notifications}),Xe.jsx("button",{onClick:f,className:"text-[10px] font-bold text-emerald-600 hover:text-emerald-700",children:N.markAllRead})]}),Xe.jsxs("div",{className:"p-2 space-y-2",children:[0===x.filter(t=>t.userId===(null==e?void 0:e.id)).length&&Xe.jsx("div",{className:"p-4 text-xs text-slate-400 text-center",children:N.noNotifications}),x.filter(t=>t.userId===(null==e?void 0:e.id)).map(e=>Xe.jsxs("div",{className:"px-3 py-2 rounded-xl text-xs "+(e.isRead?"bg-slate-50 dark:bg-slate-800 text-slate-500":"bg-emerald-50 dark:bg-emerald-900/20 text-slate-700"),children:[Xe.jsx("p",{className:"font-semibold",children:e.message}),Xe.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:new Date(e.timestamp).toLocaleString("pt-PT")})]},e.id))]})]})]}),Xe.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 pl-4 sm:pl-6 border-l border-slate-100 dark:border-slate-800",children:[Xe.jsxs("div",{className:"text-right hidden sm:block",children:[Xe.jsx("p",{className:"text-sm font-black text-slate-900 dark:text-white leading-none",children:null==e?void 0:e.name}),Xe.jsx("p",{className:"text-[10px] font-bold text-[#10b981] uppercase tracking-widest mt-1.5",children:(null==e?void 0:e.position)||(null==e?void 0:e.role)})]}),Xe.jsx("button",{type:"button",onClick:()=>e&&Y(e.id),className:"flex-shrink-0 rounded-2xl border-2 border-white dark:border-slate-800 shadow-xl overflow-hidden w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center bg-slate-100 dark:bg-slate-800 ring-1 ring-slate-100",children:e&&u(e)?Xe.jsx("img",{src:u(e),alt:e.name,className:"w-full h-full object-cover"}):Xe.jsx(Ia,{size:22,className:"text-slate-400"})})]})]})]}),Xe.jsxs("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 lg:p-10 bg-[#f8fafc] dark:bg-slate-950",children:["dashboard"===g&&e&&Xe.jsx(gr,{stats:B,tasks:a,users:c,visibleActivities:v,user:e}),"tasks"===g&&e&&Xe.jsx(ur,{tasks:r,users:c,user:e,onAdvanceStatus:l,onRegressStatus:n,onDeleteTask:o,onAddComment:d,onSearchChange:e=>{V(e),i({search:e,status:G})},onStatusFilterChange:e=>{H(e),i({search:Q,status:e})},searchQuery:Q,statusFilter:G}),"users"===g&&(null==e?void 0:e.role)===us.ADMIN&&Xe.jsx(fr,{users:c,currentUser:e,onUpdateUser:h,onDeleteUser:p,onAvatarUpload:Y,getAvatarUrl:u}),"profile"===g&&e&&Xe.jsx(wr,{user:e,users:c,setUser:t,profilePassword:U,setProfilePassword:z,profilePasswordConfirm:F,setProfilePasswordConfirm:L,profilePasswordError:q,setProfilePasswordError:$,profilePasswordSuccess:_,setProfilePasswordSuccess:W,setActiveTabSafe:K,onAvatarUpload:Y,getAvatarUrl:u,updateUser:h,addNotification:b}),"reports"===g&&(null==e?void 0:e.role)===us.ADMIN&&Xe.jsx(jr,{tasks:a,users:c})]})]})]})},Ar=()=>{const{view:e}=(()=>{const e=qe.useContext(Ys);if(!e)throw new Error("useApp must be used within AppProvider");return{user:e.user,setUser:e.setUser,tasks:e.tasks,setTasks:e.setTasks,users:e.users,setUsers:e.setUsers,notifications:e.notifications,setNotifications:e.setNotifications,systemActivities:e.systemActivities,setSystemActivities:e.setSystemActivities,view:e.view,setView:e.setView,activeTab:e.activeTab,setActiveTab:e.setActiveTab,lang:e.lang,setLang:e.setLang,theme:e.theme,setTheme:e.setTheme,isLoading:e.isLoading,setIsLoading:e.setIsLoading,login:e.login,logout:e.logout,register:e.register,validateSetupToken:e.validateSetupToken,setupPassword:e.setupPassword,validateResetToken:e.validateResetToken,resetPassword:e.resetPassword,createTask:e.createTask,updateTask:e.updateTask,deleteTask:e.deleteTask,handleAdvanceStatus:e.handleAdvanceStatus,handleDeleteTask:e.handleDeleteTask,addComment:e.addComment,filterTasks:e.filterTasks,filteredTasks:e.filteredTasks,loadUsers:e.loadUsers,createUser:e.createUser,updateUser:e.updateUser,deleteUser:e.deleteUser,addNotification:e.addNotification,markAllNotificationsAsRead:e.markAllNotificationsAsRead,addSystemActivity:e.addSystemActivity,loadDataFromAPI:e.loadDataFromAPI,getAvatarUrl:e.getAvatarUrl,saveAvatar:e.saveAvatar,openAvatarUpload:e.openAvatarUpload}})();switch(e){case"landing":return Xe.jsx(Ba,{});case"login":default:return Xe.jsx(Va,{});case"set-password":return Xe.jsx(Ga,{});case"reset-password":return Xe.jsx(Ha,{});case"app":return Xe.jsx(Nr,{})}},Sr=new es({defaultOptions:{queries:{staleTime:3e5,refetchOnWindowFocus:!0,refetchOnReconnect:!0}}});Ze.createRoot(document.getElementById("root")).render(Xe.jsx(_e.StrictMode,{children:Xe.jsxs(as,{client:Sr,children:[Xe.jsx(Bs,{children:Xe.jsx(Ar,{})}),Xe.jsx(cs,{initialIsOpen:!1})]})}));
